{"version":3,"file":"photo-editor.js","mappings":"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","sources":["webpack://workspace/webpack/runtime/chunk loaded","webpack://workspace/./src/core/photo-editor.ts","webpack://workspace/./src/ui/photo-editor.ts","webpack://workspace/webpack/bootstrap","webpack://workspace/webpack/runtime/define property getters","webpack://workspace/webpack/runtime/hasOwnProperty shorthand","webpack://workspace/webpack/runtime/jsonp chunk loading","webpack://workspace/webpack/startup"],"sourcesContent":["var deferred = [];\n__webpack_require__.O = (result, chunkIds, fn, priority) => {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar [chunkIds, fn, priority] = deferred[i];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","import { Logger } from './logger';\n\nexport interface PhotoEditOptions {\n  brightness?: number; // -100 to 100\n  contrast?: number; // -100 to 100\n  saturation?: number; // -100 to 100\n  rotation?: number; // 0, 90, 180, 270\n  crop?: {\n    x: number;\n    y: number;\n    width: number;\n    height: number;\n  };\n  filter?: 'none' | 'vintage' | 'blackwhite' | 'sepia' | 'vibrant' | 'cool' | 'warm';\n  resize?: {\n    width: number;\n    height: number;\n    quality?: number; // 0.1 to 1.0\n  };\n}\n\nexport interface EditedPhoto {\n  originalUrl: string;\n  editedDataUrl: string;\n  fileName: string;\n  editOptions: PhotoEditOptions;\n  timestamp: number;\n}\n\nexport class PhotoEditor {\n  private logger = new Logger('PhotoEditor');\n  private canvas: HTMLCanvasElement;\n  private ctx: CanvasRenderingContext2D;\n\n  constructor() {\n    this.canvas = document.createElement('canvas');\n    this.ctx = this.canvas.getContext('2d')!;\n  }\n\n  /**\n   * Apply edits to a photo and return the edited image data\n   */\n  async editPhoto(imageUrl: string, options: PhotoEditOptions): Promise<EditedPhoto> {\n    this.logger.info('Starting photo edit process', { imageUrl, options });\n\n    try {\n      // Load the image\n      const img = await this.loadImage(imageUrl);\n      \n      // Apply rotation first (affects canvas dimensions)\n      const rotatedDimensions = this.calculateRotatedDimensions(img.width, img.height, options.rotation || 0);\n      \n      // Set canvas size\n      this.canvas.width = rotatedDimensions.width;\n      this.canvas.height = rotatedDimensions.height;\n      \n      // Clear canvas\n      this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n      \n      // Apply transformations\n      this.ctx.save();\n      \n      // Apply rotation\n      if (options.rotation) {\n        this.applyRotation(options.rotation, img.width, img.height);\n      }\n      \n      // Draw the image\n      this.ctx.drawImage(img, 0, 0);\n      \n      this.ctx.restore();\n      \n      // Apply crop if specified\n      if (options.crop) {\n        this.applyCrop(options.crop);\n      }\n      \n      // Apply filters and adjustments\n      await this.applyImageAdjustments(options);\n      \n      // Apply preset filters\n      if (options.filter && options.filter !== 'none') {\n        this.applyFilter(options.filter);\n      }\n      \n      // Resize if specified\n      if (options.resize) {\n        await this.applyResize(options.resize);\n      }\n      \n      // Get the final image data\n      const quality = options.resize?.quality || 0.9;\n      const editedDataUrl = this.canvas.toDataURL('image/jpeg', quality);\n      \n      const editedPhoto: EditedPhoto = {\n        originalUrl: imageUrl,\n        editedDataUrl,\n        fileName: this.generateFileName(imageUrl, options),\n        editOptions: options,\n        timestamp: Date.now()\n      };\n      \n      this.logger.info('Photo edit completed successfully');\n      return editedPhoto;\n      \n    } catch (error) {\n      this.logger.error('Failed to edit photo:', error);\n      throw new Error(`Photo editing failed: ${error instanceof Error ? error.message : 'Unknown error'}`);\n    }\n  }\n\n  /**\n   * Apply automatic enhancement to improve photo quality\n   */\n  async autoEnhance(imageUrl: string): Promise<EditedPhoto> {\n    this.logger.info('Applying automatic enhancement');\n    \n    // Analyze the image to determine optimal adjustments\n    const img = await this.loadImage(imageUrl);\n    const analysis = await this.analyzeImage(img);\n    \n    const enhancementOptions: PhotoEditOptions = {\n      brightness: analysis.suggestedBrightness,\n      contrast: analysis.suggestedContrast,\n      saturation: analysis.suggestedSaturation,\n      filter: analysis.suggestedFilter\n    };\n    \n    return this.editPhoto(imageUrl, enhancementOptions);\n  }\n\n  /**\n   * Create multiple variations of a photo for A/B testing\n   */\n  async createVariations(imageUrl: string): Promise<EditedPhoto[]> {\n    this.logger.info('Creating photo variations');\n    \n    const variations: PhotoEditOptions[] = [\n      { brightness: 10, contrast: 15, saturation: 5 }, // Bright & vibrant\n      { filter: 'vibrant', contrast: 10 }, // Enhanced colors\n      { filter: 'warm', brightness: 5 }, // Warm tone\n      { filter: 'cool', contrast: 20 }, // Cool & sharp\n      { brightness: -5, contrast: 25, saturation: -10 } // High contrast\n    ];\n    \n    const editedPhotos = await Promise.all(\n      variations.map(options => this.editPhoto(imageUrl, options))\n    );\n    \n    return editedPhotos;\n  }\n\n  /**\n   * Load an image from URL\n   */\n  private loadImage(url: string): Promise<HTMLImageElement> {\n    return new Promise((resolve, reject) => {\n      const img = new Image();\n      img.crossOrigin = 'anonymous';\n      \n      img.onload = () => resolve(img);\n      img.onerror = () => reject(new Error('Failed to load image'));\n      \n      img.src = url;\n    });\n  }\n\n  /**\n   * Calculate dimensions after rotation\n   */\n  private calculateRotatedDimensions(width: number, height: number, rotation: number) {\n    const rad = (rotation * Math.PI) / 180;\n    const cos = Math.abs(Math.cos(rad));\n    const sin = Math.abs(Math.sin(rad));\n    \n    return {\n      width: Math.ceil(width * cos + height * sin),\n      height: Math.ceil(width * sin + height * cos)\n    };\n  }\n\n  /**\n   * Apply rotation transformation\n   */\n  private applyRotation(rotation: number, originalWidth: number, originalHeight: number) {\n    const centerX = this.canvas.width / 2;\n    const centerY = this.canvas.height / 2;\n    \n    this.ctx.translate(centerX, centerY);\n    this.ctx.rotate((rotation * Math.PI) / 180);\n    this.ctx.translate(-originalWidth / 2, -originalHeight / 2);\n  }\n\n  /**\n   * Apply crop to the current canvas\n   */\n  private applyCrop(crop: { x: number; y: number; width: number; height: number }) {\n    const imageData = this.ctx.getImageData(crop.x, crop.y, crop.width, crop.height);\n    this.canvas.width = crop.width;\n    this.canvas.height = crop.height;\n    this.ctx.clearRect(0, 0, crop.width, crop.height);\n    this.ctx.putImageData(imageData, 0, 0);\n  }\n\n  /**\n   * Apply brightness, contrast, and saturation adjustments\n   */\n  private async applyImageAdjustments(options: PhotoEditOptions) {\n    if (!options.brightness && !options.contrast && !options.saturation) return;\n    \n    const imageData = this.ctx.getImageData(0, 0, this.canvas.width, this.canvas.height);\n    const data = imageData.data;\n    \n    const brightness = (options.brightness || 0) * 2.55; // Convert to 0-255 range\n    const contrast = ((options.contrast || 0) + 100) / 100; // Convert to multiplier\n    const saturation = ((options.saturation || 0) + 100) / 100; // Convert to multiplier\n    \n    for (let i = 0; i < data.length; i += 4) {\n      // Apply brightness\n      data[i] += brightness;     // Red\n      data[i + 1] += brightness; // Green\n      data[i + 2] += brightness; // Blue\n      \n      // Apply contrast\n      data[i] = ((data[i] - 128) * contrast) + 128;\n      data[i + 1] = ((data[i + 1] - 128) * contrast) + 128;\n      data[i + 2] = ((data[i + 2] - 128) * contrast) + 128;\n      \n      // Apply saturation\n      if (saturation !== 1) {\n        const gray = 0.299 * data[i] + 0.587 * data[i + 1] + 0.114 * data[i + 2];\n        data[i] = gray + (data[i] - gray) * saturation;\n        data[i + 1] = gray + (data[i + 1] - gray) * saturation;\n        data[i + 2] = gray + (data[i + 2] - gray) * saturation;\n      }\n      \n      // Clamp values to 0-255 range\n      data[i] = Math.max(0, Math.min(255, data[i]));\n      data[i + 1] = Math.max(0, Math.min(255, data[i + 1]));\n      data[i + 2] = Math.max(0, Math.min(255, data[i + 2]));\n    }\n    \n    this.ctx.putImageData(imageData, 0, 0);\n  }\n\n  /**\n   * Apply preset filters\n   */\n  private applyFilter(filter: string) {\n    const imageData = this.ctx.getImageData(0, 0, this.canvas.width, this.canvas.height);\n    const data = imageData.data;\n    \n    switch (filter) {\n      case 'blackwhite':\n        this.applyGrayscaleFilter(data);\n        break;\n      case 'sepia':\n        this.applySepiaFilter(data);\n        break;\n      case 'vintage':\n        this.applyVintageFilter(data);\n        break;\n      case 'vibrant':\n        this.applyVibrantFilter(data);\n        break;\n      case 'cool':\n        this.applyCoolFilter(data);\n        break;\n      case 'warm':\n        this.applyWarmFilter(data);\n        break;\n    }\n    \n    this.ctx.putImageData(imageData, 0, 0);\n  }\n\n  private applyGrayscaleFilter(data: Uint8ClampedArray) {\n    for (let i = 0; i < data.length; i += 4) {\n      const gray = 0.299 * data[i] + 0.587 * data[i + 1] + 0.114 * data[i + 2];\n      data[i] = gray;\n      data[i + 1] = gray;\n      data[i + 2] = gray;\n    }\n  }\n\n  private applySepiaFilter(data: Uint8ClampedArray) {\n    for (let i = 0; i < data.length; i += 4) {\n      const r = data[i], g = data[i + 1], b = data[i + 2];\n      data[i] = Math.min(255, (r * 0.393) + (g * 0.769) + (b * 0.189));\n      data[i + 1] = Math.min(255, (r * 0.349) + (g * 0.686) + (b * 0.168));\n      data[i + 2] = Math.min(255, (r * 0.272) + (g * 0.534) + (b * 0.131));\n    }\n  }\n\n  private applyVintageFilter(data: Uint8ClampedArray) {\n    for (let i = 0; i < data.length; i += 4) {\n      data[i] = Math.min(255, data[i] * 1.1); // Enhance red\n      data[i + 1] = Math.min(255, data[i + 1] * 0.9); // Reduce green\n      data[i + 2] = Math.min(255, data[i + 2] * 0.8); // Reduce blue\n    }\n  }\n\n  private applyVibrantFilter(data: Uint8ClampedArray) {\n    for (let i = 0; i < data.length; i += 4) {\n      const max = Math.max(data[i], data[i + 1], data[i + 2]);\n      const factor = max > 128 ? 1.2 : 1.1;\n      data[i] = Math.min(255, data[i] * factor);\n      data[i + 1] = Math.min(255, data[i + 1] * factor);\n      data[i + 2] = Math.min(255, data[i + 2] * factor);\n    }\n  }\n\n  private applyCoolFilter(data: Uint8ClampedArray) {\n    for (let i = 0; i < data.length; i += 4) {\n      data[i] = Math.min(255, data[i] * 0.9); // Reduce red\n      data[i + 1] = Math.min(255, data[i + 1] * 1.0); // Keep green\n      data[i + 2] = Math.min(255, data[i + 2] * 1.1); // Enhance blue\n    }\n  }\n\n  private applyWarmFilter(data: Uint8ClampedArray) {\n    for (let i = 0; i < data.length; i += 4) {\n      data[i] = Math.min(255, data[i] * 1.1); // Enhance red\n      data[i + 1] = Math.min(255, data[i + 1] * 1.05); // Slightly enhance green\n      data[i + 2] = Math.min(255, data[i + 2] * 0.9); // Reduce blue\n    }\n  }\n\n  /**\n   * Resize the image\n   */\n  private async applyResize(resize: { width: number; height: number }) {\n    const currentImageData = this.ctx.getImageData(0, 0, this.canvas.width, this.canvas.height);\n    \n    // Create a temporary canvas for resizing\n    const tempCanvas = document.createElement('canvas');\n    const tempCtx = tempCanvas.getContext('2d')!;\n    \n    tempCanvas.width = this.canvas.width;\n    tempCanvas.height = this.canvas.height;\n    tempCtx.putImageData(currentImageData, 0, 0);\n    \n    // Resize main canvas\n    this.canvas.width = resize.width;\n    this.canvas.height = resize.height;\n    \n    // Draw resized image\n    this.ctx.drawImage(tempCanvas, 0, 0, resize.width, resize.height);\n  }\n\n  /**\n   * Analyze image to suggest automatic enhancements\n   */\n  private async analyzeImage(img: HTMLImageElement) {\n    // Create temporary canvas for analysis\n    const analysisCanvas = document.createElement('canvas');\n    const analysisCtx = analysisCanvas.getContext('2d')!;\n    \n    // Use smaller size for faster analysis\n    const analysisSize = 100;\n    analysisCanvas.width = analysisSize;\n    analysisCanvas.height = analysisSize;\n    \n    analysisCtx.drawImage(img, 0, 0, analysisSize, analysisSize);\n    const imageData = analysisCtx.getImageData(0, 0, analysisSize, analysisSize);\n    const data = imageData.data;\n    \n    let totalBrightness = 0;\n    let totalSaturation = 0;\n    let redTotal = 0, blueTotal = 0;\n    const pixelCount = data.length / 4;\n    \n    for (let i = 0; i < data.length; i += 4) {\n      const r = data[i], g = data[i + 1], b = data[i + 2];\n      \n      // Calculate brightness\n      const brightness = (r + g + b) / 3;\n      totalBrightness += brightness;\n      \n      // Calculate saturation\n      const max = Math.max(r, g, b);\n      const min = Math.min(r, g, b);\n      const saturation = max === 0 ? 0 : (max - min) / max;\n      totalSaturation += saturation;\n      \n      redTotal += r;\n      blueTotal += b;\n    }\n    \n    const avgBrightness = totalBrightness / pixelCount;\n    const avgSaturation = totalSaturation / pixelCount;\n    const avgRed = redTotal / pixelCount;\n    const avgBlue = blueTotal / pixelCount;\n    \n    // Determine suggested adjustments\n    let suggestedBrightness = 0;\n    let suggestedContrast = 0;\n    let suggestedSaturation = 0;\n    let suggestedFilter: PhotoEditOptions['filter'] = 'none';\n    \n    // Brightness adjustment\n    if (avgBrightness < 80) {\n      suggestedBrightness = 15; // Brighten dark images\n    } else if (avgBrightness > 200) {\n      suggestedBrightness = -10; // Darken overly bright images\n    }\n    \n    // Contrast adjustment\n    if (avgBrightness > 100 && avgBrightness < 180) {\n      suggestedContrast = 15; // Add contrast to mid-tone images\n    }\n    \n    // Saturation adjustment\n    if (avgSaturation < 0.3) {\n      suggestedSaturation = 20; // Boost saturation for dull images\n    }\n    \n    // Filter suggestion based on color temperature\n    const isWarm = avgRed > avgBlue + 10;\n    const isCool = avgBlue > avgRed + 10;\n    \n    if (isWarm && avgSaturation > 0.4) {\n      suggestedFilter = 'vibrant';\n    } else if (isCool) {\n      suggestedFilter = 'warm';\n    } else if (avgSaturation < 0.2) {\n      suggestedFilter = 'vibrant';\n    }\n    \n    return {\n      suggestedBrightness,\n      suggestedContrast,\n      suggestedSaturation,\n      suggestedFilter,\n      avgBrightness,\n      avgSaturation\n    };\n  }\n\n  /**\n   * Generate a filename for the edited photo\n   */\n  private generateFileName(_originalUrl: string, options: PhotoEditOptions): string {\n    const timestamp = Date.now();\n    const editSuffix = Object.keys(options).join('-');\n    return `edited-${timestamp}-${editSuffix}.jpg`;\n  }\n\n  /**\n   * Batch process multiple photos with the same options\n   */\n  async batchEdit(imageUrls: string[], options: PhotoEditOptions): Promise<EditedPhoto[]> {\n    this.logger.info(`Starting batch edit for ${imageUrls.length} photos`);\n    \n    const editedPhotos = await Promise.all(\n      imageUrls.map(url => this.editPhoto(url, options))\n    );\n    \n    this.logger.info(`Batch edit completed for ${editedPhotos.length} photos`);\n    return editedPhotos;\n  }\n}","import { PhotoEditor, PhotoEditOptions, EditedPhoto } from '../core/photo-editor';\nimport { Logger } from '../core/logger';\n\ninterface PhotoState {\n  originalUrl: string;\n  currentImageData: string;\n  editHistory: PhotoEditOptions[];\n  currentEdit: PhotoEditOptions;\n}\n\nclass PhotoEditorUI {\n  private logger = new Logger('PhotoEditorUI');\n  private photoEditor = new PhotoEditor();\n  private canvas: HTMLCanvasElement;\n  private ctx: CanvasRenderingContext2D;\n  private currentPhoto: PhotoState | null = null;\n  private photos: PhotoState[] = [];\n  private currentPhotoIndex = 0;\n  private zoomLevel = 1;\n  private cropMode = false;\n  private cropSelection: { x: number; y: number; width: number; height: number } | null = null;\n\n  constructor() {\n    this.canvas = document.getElementById('editCanvas') as HTMLCanvasElement;\n    this.ctx = this.canvas.getContext('2d')!;\n    this.init();\n  }\n\n  private async init() {\n    this.logger.info('Initializing Photo Editor UI');\n    \n    try {\n      this.setupEventListeners();\n      this.loadPhotosFromStorage();\n      this.updateUI();\n      \n      this.logger.info('Photo Editor UI initialized successfully');\n    } catch (error) {\n      this.logger.error('Failed to initialize photo editor:', error);\n    }\n  }\n\n  private setupEventListeners() {\n    // Header buttons\n    document.getElementById('backBtn')?.addEventListener('click', () => this.goBack());\n    document.getElementById('autoEnhanceBtn')?.addEventListener('click', () => this.autoEnhance());\n    document.getElementById('saveBtn')?.addEventListener('click', () => this.saveCurrentPhoto());\n\n    // Basic adjustment sliders\n    this.setupSlider('brightnessSlider', 'brightnessValue', 'brightness');\n    this.setupSlider('contrastSlider', 'contrastValue', 'contrast');\n    this.setupSlider('saturationSlider', 'saturationValue', 'saturation');\n\n    // Transform buttons\n    document.getElementById('rotate90Btn')?.addEventListener('click', () => this.rotate(90));\n    document.getElementById('rotate180Btn')?.addEventListener('click', () => this.rotate(180));\n    document.getElementById('rotate270Btn')?.addEventListener('click', () => this.rotate(270));\n    document.getElementById('cropBtn')?.addEventListener('click', () => this.toggleCropMode());\n\n    // Filter buttons\n    document.querySelectorAll('.filter-btn').forEach(btn => {\n      btn.addEventListener('click', () => {\n        const filter = btn.getAttribute('data-filter') as PhotoEditOptions['filter'];\n        this.applyFilter(filter);\n        this.updateFilterUI(btn);\n      });\n    });\n\n    // Resize controls\n    this.setupResizeControls();\n\n    // Batch actions\n    document.getElementById('createVariationsBtn')?.addEventListener('click', () => this.createVariations());\n    document.getElementById('batchApplyBtn')?.addEventListener('click', () => this.batchApplyCurrentSettings());\n\n    // Reset button\n    document.getElementById('resetBtn')?.addEventListener('click', () => this.resetAllEdits());\n\n    // Canvas controls\n    document.getElementById('zoomInBtn')?.addEventListener('click', () => this.zoomIn());\n    document.getElementById('zoomOutBtn')?.addEventListener('click', () => this.zoomOut());\n    document.getElementById('fitToScreenBtn')?.addEventListener('click', () => this.fitToScreen());\n\n    // Photo management\n    document.getElementById('addPhotosBtn')?.addEventListener('click', () => this.addPhotos());\n    document.getElementById('photoFileInput')?.addEventListener('change', (e) => this.handleFileSelection(e));\n\n    // Canvas interaction for cropping\n    this.setupCanvasInteraction();\n  }\n\n  private setupSlider(sliderId: string, valueId: string, property: keyof PhotoEditOptions) {\n    const slider = document.getElementById(sliderId) as HTMLInputElement;\n    const valueDisplay = document.getElementById(valueId);\n    \n    slider?.addEventListener('input', () => {\n      const value = parseInt(slider.value);\n      if (valueDisplay) valueDisplay.textContent = value.toString();\n      \n      if (this.currentPhoto) {\n        this.currentPhoto.currentEdit[property] = value as any;\n        this.applyCurrentEdits();\n      }\n    });\n  }\n\n  private setupResizeControls() {\n    const widthInput = document.getElementById('widthInput') as HTMLInputElement;\n    const heightInput = document.getElementById('heightInput') as HTMLInputElement;\n    const aspectRatioCheckbox = document.getElementById('maintainAspectRatio') as HTMLInputElement;\n    const qualitySlider = document.getElementById('qualitySlider') as HTMLInputElement;\n    const qualityValue = document.getElementById('qualityValue');\n\n    let aspectRatio = 1;\n\n    const updateAspectRatio = () => {\n      if (this.currentPhoto && widthInput.value && heightInput.value) {\n        aspectRatio = parseInt(widthInput.value) / parseInt(heightInput.value);\n      }\n    };\n\n    widthInput?.addEventListener('input', () => {\n      if (aspectRatioCheckbox.checked && heightInput.value) {\n        const newHeight = Math.round(parseInt(widthInput.value) / aspectRatio);\n        heightInput.value = newHeight.toString();\n      }\n      this.updateResize();\n    });\n\n    heightInput?.addEventListener('input', () => {\n      if (aspectRatioCheckbox.checked && widthInput.value) {\n        const newWidth = Math.round(parseInt(heightInput.value) * aspectRatio);\n        widthInput.value = newWidth.toString();\n      }\n      this.updateResize();\n    });\n\n    aspectRatioCheckbox?.addEventListener('change', () => {\n      if (aspectRatioCheckbox.checked) {\n        updateAspectRatio();\n      }\n    });\n\n    qualitySlider?.addEventListener('input', () => {\n      const value = parseInt(qualitySlider.value);\n      if (qualityValue) qualityValue.textContent = `${value}%`;\n      this.updateResize();\n    });\n\n    // Initialize aspect ratio when photo is loaded\n    updateAspectRatio();\n  }\n\n  private updateResize() {\n    if (!this.currentPhoto) return;\n\n    const widthInput = document.getElementById('widthInput') as HTMLInputElement;\n    const heightInput = document.getElementById('heightInput') as HTMLInputElement;\n    const qualitySlider = document.getElementById('qualitySlider') as HTMLInputElement;\n\n    if (widthInput.value && heightInput.value) {\n      this.currentPhoto.currentEdit.resize = {\n        width: parseInt(widthInput.value),\n        height: parseInt(heightInput.value),\n        quality: parseInt(qualitySlider.value) / 100\n      };\n      this.applyCurrentEdits();\n    }\n  }\n\n  private setupCanvasInteraction() {\n    let isDragging = false;\n    let startX = 0, startY = 0;\n\n    this.canvas.addEventListener('mousedown', (e) => {\n      if (!this.cropMode) return;\n\n      isDragging = true;\n      const rect = this.canvas.getBoundingClientRect();\n      startX = e.clientX - rect.left;\n      startY = e.clientY - rect.top;\n\n      this.cropSelection = { x: startX, y: startY, width: 0, height: 0 };\n      this.updateCropOverlay();\n    });\n\n    this.canvas.addEventListener('mousemove', (e) => {\n      if (!isDragging || !this.cropMode || !this.cropSelection) return;\n\n      const rect = this.canvas.getBoundingClientRect();\n      const currentX = e.clientX - rect.left;\n      const currentY = e.clientY - rect.top;\n\n      this.cropSelection.width = currentX - startX;\n      this.cropSelection.height = currentY - startY;\n      this.updateCropOverlay();\n    });\n\n    this.canvas.addEventListener('mouseup', () => {\n      if (isDragging && this.cropMode && this.cropSelection) {\n        this.applyCrop();\n      }\n      isDragging = false;\n    });\n  }\n\n  private async loadPhotosFromStorage() {\n    try {\n      const result = await chrome.storage.local.get(['vehiclePhotos']);\n      const storedPhotos = result.vehiclePhotos || [];\n      \n      this.photos = storedPhotos.map((url: string) => ({\n        originalUrl: url,\n        currentImageData: url,\n        editHistory: [],\n        currentEdit: {}\n      }));\n\n      if (this.photos.length > 0) {\n        this.currentPhotoIndex = 0;\n        this.currentPhoto = this.photos[0];\n        await this.loadCurrentPhoto();\n      }\n\n      this.updatePhotosPanel();\n    } catch (error) {\n      this.logger.error('Failed to load photos from storage:', error);\n    }\n  }\n\n  private async loadCurrentPhoto() {\n    if (!this.currentPhoto) return;\n\n    try {\n      this.showLoading(true);\n      \n      const img = new Image();\n      img.crossOrigin = 'anonymous';\n      img.onload = () => {\n        this.canvas.width = img.width;\n        this.canvas.height = img.height;\n        this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n        this.ctx.drawImage(img, 0, 0);\n        \n        this.fitToScreen();\n        this.updateResizeInputs(img.width, img.height);\n        this.showLoading(false);\n      };\n      \n      img.src = this.currentPhoto.currentImageData;\n    } catch (error) {\n      this.logger.error('Failed to load current photo:', error);\n      this.showLoading(false);\n    }\n  }\n\n  private async applyCurrentEdits() {\n    if (!this.currentPhoto) return;\n\n    try {\n      this.showLoading(true);\n      \n      const editedPhoto = await this.photoEditor.editPhoto(\n        this.currentPhoto.originalUrl,\n        this.currentPhoto.currentEdit\n      );\n      \n      this.currentPhoto.currentImageData = editedPhoto.editedDataUrl;\n      \n      // Load the edited image onto canvas\n      const img = new Image();\n      img.onload = () => {\n        this.canvas.width = img.width;\n        this.canvas.height = img.height;\n        this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n        this.ctx.drawImage(img, 0, 0);\n        this.showLoading(false);\n      };\n      img.src = editedPhoto.editedDataUrl;\n      \n    } catch (error) {\n      this.logger.error('Failed to apply edits:', error);\n      this.showLoading(false);\n    }\n  }\n\n  private async autoEnhance() {\n    if (!this.currentPhoto) return;\n\n    try {\n      this.showLoading(true);\n      \n      const enhancedPhoto = await this.photoEditor.autoEnhance(this.currentPhoto.originalUrl);\n      this.currentPhoto.currentEdit = enhancedPhoto.editOptions;\n      this.currentPhoto.currentImageData = enhancedPhoto.editedDataUrl;\n      \n      this.updateControlsFromEdit();\n      await this.loadCurrentPhoto();\n      \n    } catch (error) {\n      this.logger.error('Auto enhance failed:', error);\n      this.showLoading(false);\n    }\n  }\n\n  private applyFilter(filter: PhotoEditOptions['filter']) {\n    if (!this.currentPhoto) return;\n\n    this.currentPhoto.currentEdit.filter = filter;\n    this.applyCurrentEdits();\n  }\n\n  private updateFilterUI(activeBtn: Element) {\n    document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));\n    activeBtn.classList.add('active');\n  }\n\n  private rotate(degrees: number) {\n    if (!this.currentPhoto) return;\n\n    this.currentPhoto.currentEdit.rotation = \n      ((this.currentPhoto.currentEdit.rotation || 0) + degrees) % 360;\n    this.applyCurrentEdits();\n  }\n\n  private toggleCropMode() {\n    this.cropMode = !this.cropMode;\n    const cropOverlay = document.getElementById('cropOverlay');\n    const cropBtn = document.getElementById('cropBtn');\n    \n    if (this.cropMode) {\n      cropOverlay?.classList.remove('hidden');\n      cropBtn?.classList.add('active');\n    } else {\n      cropOverlay?.classList.add('hidden');\n      cropBtn?.classList.remove('active');\n      this.cropSelection = null;\n    }\n  }\n\n  private updateCropOverlay() {\n    if (!this.cropSelection) return;\n\n    const overlay = document.querySelector('.crop-selection') as HTMLElement;\n    if (overlay) {\n      overlay.style.left = `${Math.min(this.cropSelection.x, this.cropSelection.x + this.cropSelection.width)}px`;\n      overlay.style.top = `${Math.min(this.cropSelection.y, this.cropSelection.y + this.cropSelection.height)}px`;\n      overlay.style.width = `${Math.abs(this.cropSelection.width)}px`;\n      overlay.style.height = `${Math.abs(this.cropSelection.height)}px`;\n    }\n  }\n\n  private applyCrop() {\n    if (!this.currentPhoto || !this.cropSelection) return;\n\n    // Adjust crop coordinates for canvas scaling\n    const rect = this.canvas.getBoundingClientRect();\n    const scaleX = this.canvas.width / rect.width;\n    const scaleY = this.canvas.height / rect.height;\n\n    this.currentPhoto.currentEdit.crop = {\n      x: Math.min(this.cropSelection.x, this.cropSelection.x + this.cropSelection.width) * scaleX,\n      y: Math.min(this.cropSelection.y, this.cropSelection.y + this.cropSelection.height) * scaleY,\n      width: Math.abs(this.cropSelection.width) * scaleX,\n      height: Math.abs(this.cropSelection.height) * scaleY\n    };\n\n    this.applyCurrentEdits();\n    this.toggleCropMode();\n  }\n\n  private async createVariations() {\n    if (!this.currentPhoto) return;\n\n    try {\n      this.showLoading(true);\n      \n      const variations = await this.photoEditor.createVariations(this.currentPhoto.originalUrl);\n      this.displayVariations(variations);\n      \n      this.showLoading(false);\n    } catch (error) {\n      this.logger.error('Failed to create variations:', error);\n      this.showLoading(false);\n    }\n  }\n\n  private displayVariations(variations: EditedPhoto[]) {\n    const variationsSection = document.getElementById('variationsSection');\n    const variationsGrid = document.getElementById('variationsGrid');\n    \n    if (!variationsSection || !variationsGrid) return;\n\n    variationsGrid.innerHTML = '';\n    \n    variations.forEach((variation, index) => {\n      const variationElement = document.createElement('div');\n      variationElement.className = 'variation-item';\n      \n      variationElement.innerHTML = `\n        <img src=\"${variation.editedDataUrl}\" alt=\"Variation ${index + 1}\" class=\"variation-thumb\">\n        <div class=\"variation-label\">Variation ${index + 1}</div>\n      `;\n      \n      variationElement.addEventListener('click', () => {\n        if (this.currentPhoto) {\n          this.currentPhoto.currentEdit = variation.editOptions;\n          this.currentPhoto.currentImageData = variation.editedDataUrl;\n          this.updateControlsFromEdit();\n          this.loadCurrentPhoto();\n        }\n      });\n      \n      variationsGrid.appendChild(variationElement);\n    });\n    \n    variationsSection.classList.remove('hidden');\n  }\n\n  private async batchApplyCurrentSettings() {\n    if (!this.currentPhoto || this.photos.length <= 1) return;\n\n    try {\n      this.showLoading(true);\n      \n      const otherPhotoUrls = this.photos\n        .filter((_, index) => index !== this.currentPhotoIndex)\n        .map(photo => photo.originalUrl);\n      \n      const editedPhotos = await this.photoEditor.batchEdit(\n        otherPhotoUrls,\n        this.currentPhoto.currentEdit\n      );\n      \n      // Update other photos with edited versions\n      editedPhotos.forEach((editedPhoto, index) => {\n        const photoIndex = index < this.currentPhotoIndex ? index : index + 1;\n        this.photos[photoIndex].currentEdit = editedPhoto.editOptions;\n        this.photos[photoIndex].currentImageData = editedPhoto.editedDataUrl;\n      });\n      \n      this.updatePhotosPanel();\n      this.showLoading(false);\n      \n    } catch (error) {\n      this.logger.error('Batch apply failed:', error);\n      this.showLoading(false);\n    }\n  }\n\n  private resetAllEdits() {\n    if (!this.currentPhoto) return;\n\n    this.currentPhoto.currentEdit = {};\n    this.currentPhoto.currentImageData = this.currentPhoto.originalUrl;\n    this.updateControlsFromEdit();\n    this.loadCurrentPhoto();\n  }\n\n  private updateControlsFromEdit() {\n    if (!this.currentPhoto) return;\n\n    const edit = this.currentPhoto.currentEdit;\n    \n    // Update sliders\n    this.setSliderValue('brightnessSlider', 'brightnessValue', edit.brightness || 0);\n    this.setSliderValue('contrastSlider', 'contrastValue', edit.contrast || 0);\n    this.setSliderValue('saturationSlider', 'saturationValue', edit.saturation || 0);\n    \n    // Update filter buttons\n    document.querySelectorAll('.filter-btn').forEach(btn => {\n      btn.classList.remove('active');\n      if (btn.getAttribute('data-filter') === (edit.filter || 'none')) {\n        btn.classList.add('active');\n      }\n    });\n  }\n\n  private setSliderValue(sliderId: string, valueId: string, value: number) {\n    const slider = document.getElementById(sliderId) as HTMLInputElement;\n    const valueDisplay = document.getElementById(valueId);\n    \n    if (slider) slider.value = value.toString();\n    if (valueDisplay) valueDisplay.textContent = value.toString();\n  }\n\n  private updateResizeInputs(width: number, height: number) {\n    const widthInput = document.getElementById('widthInput') as HTMLInputElement;\n    const heightInput = document.getElementById('heightInput') as HTMLInputElement;\n    \n    if (widthInput) widthInput.value = width.toString();\n    if (heightInput) heightInput.value = height.toString();\n  }\n\n  private zoomIn() {\n    this.zoomLevel = Math.min(this.zoomLevel * 1.2, 5);\n    this.applyZoom();\n  }\n\n  private zoomOut() {\n    this.zoomLevel = Math.max(this.zoomLevel / 1.2, 0.1);\n    this.applyZoom();\n  }\n\n  private fitToScreen() {\n    const container = document.querySelector('.canvas-container') as HTMLElement;\n    if (!container) return;\n\n    const containerRect = container.getBoundingClientRect();\n    const scaleX = (containerRect.width - 40) / this.canvas.width;\n    const scaleY = (containerRect.height - 40) / this.canvas.height;\n    \n    this.zoomLevel = Math.min(scaleX, scaleY, 1);\n    this.applyZoom();\n  }\n\n  private applyZoom() {\n    this.canvas.style.transform = `scale(${this.zoomLevel})`;\n    \n    const zoomDisplay = document.querySelector('.zoom-level');\n    if (zoomDisplay) {\n      zoomDisplay.textContent = `${Math.round(this.zoomLevel * 100)}%`;\n    }\n  }\n\n  private addPhotos() {\n    const fileInput = document.getElementById('photoFileInput') as HTMLInputElement;\n    fileInput?.click();\n  }\n\n  private async handleFileSelection(event: Event) {\n    const input = event.target as HTMLInputElement;\n    const files = input.files;\n    \n    if (!files || files.length === 0) return;\n\n    for (const file of Array.from(files)) {\n      if (file.type.startsWith('image/')) {\n        const dataUrl = await this.fileToDataUrl(file);\n        \n        const newPhoto: PhotoState = {\n          originalUrl: dataUrl,\n          currentImageData: dataUrl,\n          editHistory: [],\n          currentEdit: {}\n        };\n        \n        this.photos.push(newPhoto);\n      }\n    }\n    \n    this.updatePhotosPanel();\n    \n    // Load the first new photo if no photo was selected\n    if (!this.currentPhoto && this.photos.length > 0) {\n      this.currentPhotoIndex = 0;\n      this.currentPhoto = this.photos[0];\n      await this.loadCurrentPhoto();\n    }\n  }\n\n  private fileToDataUrl(file: File): Promise<string> {\n    return new Promise((resolve, reject) => {\n      const reader = new FileReader();\n      reader.onload = () => resolve(reader.result as string);\n      reader.onerror = reject;\n      reader.readAsDataURL(file);\n    });\n  }\n\n  private updatePhotosPanel() {\n    const photosList = document.getElementById('photosList');\n    if (!photosList) return;\n\n    photosList.innerHTML = '';\n    \n    this.photos.forEach((photo, index) => {\n      const photoElement = document.createElement('div');\n      photoElement.className = `photo-item ${index === this.currentPhotoIndex ? 'active' : ''}`;\n      \n      photoElement.innerHTML = `\n        <img src=\"${photo.currentImageData}\" alt=\"Photo ${index + 1}\" class=\"photo-thumb\">\n        <div class=\"photo-info\">\n          <div class=\"photo-name\">Photo ${index + 1}</div>\n          <div class=\"photo-size\">Edited: ${Object.keys(photo.currentEdit).length > 0 ? 'Yes' : 'No'}</div>\n        </div>\n        <div class=\"photo-actions\">\n          <button class=\"btn btn-xs btn-tool\" onclick=\"event.stopPropagation(); this.parentElement.parentElement.remove();\"></button>\n        </div>\n      `;\n      \n      photoElement.addEventListener('click', () => {\n        this.currentPhotoIndex = index;\n        this.currentPhoto = photo;\n        this.loadCurrentPhoto();\n        this.updateControlsFromEdit();\n        this.updatePhotosPanel();\n      });\n      \n      photosList.appendChild(photoElement);\n    });\n  }\n\n  private async saveCurrentPhoto() {\n    if (!this.currentPhoto) return;\n\n    try {\n      // Create download link\n      const link = document.createElement('a');\n      link.download = `edited-photo-${Date.now()}.jpg`;\n      link.href = this.currentPhoto.currentImageData;\n      link.click();\n      \n      this.logger.info('Photo saved successfully');\n    } catch (error) {\n      this.logger.error('Failed to save photo:', error);\n    }\n  }\n\n  private goBack() {\n    // Return to main extension view\n    window.history.back();\n  }\n\n  private showLoading(show: boolean) {\n    const loadingIndicator = document.getElementById('loadingIndicator');\n    if (loadingIndicator) {\n      if (show) {\n        loadingIndicator.classList.remove('hidden');\n      } else {\n        loadingIndicator.classList.add('hidden');\n      }\n    }\n  }\n\n  private updateUI() {\n    // Update various UI elements based on current state\n    this.updatePhotosPanel();\n    if (this.currentPhoto) {\n      this.updateControlsFromEdit();\n    }\n  }\n}\n\n// Initialize when DOM is loaded\ndocument.addEventListener('DOMContentLoaded', () => {\n  new PhotoEditorUI();\n});","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t513: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = (chunkId) => (installedChunks[chunkId] === 0);\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some((id) => (installedChunks[id] !== 0))) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkworkspace\"] = self[\"webpackChunkworkspace\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [76], () => (__webpack_require__(130)))\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["deferred","PhotoEditor","constructor","logger","this","canvas","document","createElement","ctx","getContext","editPhoto","imageUrl","options","info","img","loadImage","rotatedDimensions","calculateRotatedDimensions","width","height","rotation","clearRect","save","applyRotation","drawImage","restore","crop","applyCrop","applyImageAdjustments","filter","applyFilter","resize","applyResize","quality","editedPhoto","originalUrl","editedDataUrl","toDataURL","fileName","generateFileName","editOptions","timestamp","Date","now","error","Error","message","autoEnhance","analysis","analyzeImage","enhancementOptions","brightness","suggestedBrightness","contrast","suggestedContrast","saturation","suggestedSaturation","suggestedFilter","createVariations","Promise","all","map","url","resolve","reject","Image","crossOrigin","onload","onerror","src","rad","Math","PI","cos","abs","sin","ceil","originalWidth","originalHeight","centerX","centerY","translate","rotate","imageData","getImageData","x","y","putImageData","data","i","length","gray","max","min","applyGrayscaleFilter","applySepiaFilter","applyVintageFilter","applyVibrantFilter","applyCoolFilter","applyWarmFilter","r","g","b","factor","currentImageData","tempCanvas","tempCtx","analysisCanvas","analysisCtx","analysisSize","totalBrightness","totalSaturation","redTotal","blueTotal","pixelCount","avgBrightness","avgSaturation","avgRed","avgBlue","_originalUrl","Object","keys","join","batchEdit","imageUrls","editedPhotos","PhotoEditorUI","photoEditor","currentPhoto","photos","currentPhotoIndex","zoomLevel","cropMode","cropSelection","getElementById","init","setupEventListeners","loadPhotosFromStorage","updateUI","addEventListener","goBack","saveCurrentPhoto","setupSlider","toggleCropMode","querySelectorAll","forEach","btn","getAttribute","updateFilterUI","setupResizeControls","batchApplyCurrentSettings","resetAllEdits","zoomIn","zoomOut","fitToScreen","addPhotos","e","handleFileSelection","setupCanvasInteraction","sliderId","valueId","property","slider","valueDisplay","value","parseInt","textContent","toString","currentEdit","applyCurrentEdits","widthInput","heightInput","aspectRatioCheckbox","qualitySlider","qualityValue","aspectRatio","updateAspectRatio","checked","newHeight","round","updateResize","newWidth","isDragging","startX","startY","rect","getBoundingClientRect","clientX","left","clientY","top","updateCropOverlay","currentX","currentY","storedPhotos","chrome","storage","local","get","vehiclePhotos","editHistory","loadCurrentPhoto","updatePhotosPanel","showLoading","updateResizeInputs","enhancedPhoto","updateControlsFromEdit","activeBtn","classList","remove","add","degrees","cropOverlay","cropBtn","overlay","querySelector","style","scaleX","scaleY","variations","displayVariations","variationsSection","variationsGrid","innerHTML","variation","index","variationElement","className","appendChild","otherPhotoUrls","_","photo","photoIndex","edit","setSliderValue","applyZoom","container","containerRect","transform","zoomDisplay","fileInput","click","event","files","target","file","Array","from","type","startsWith","dataUrl","fileToDataUrl","newPhoto","push","reader","FileReader","result","readAsDataURL","photosList","photoElement","link","download","href","window","history","back","show","loadingIndicator","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","O","chunkIds","fn","priority","notFulfilled","Infinity","fulfilled","j","every","key","splice","d","definition","o","defineProperty","enumerable","obj","prop","prototype","hasOwnProperty","call","installedChunks","chunkId","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","some","id","chunkLoadingGlobal","self","bind","__webpack_exports__"],"sourceRoot":""}