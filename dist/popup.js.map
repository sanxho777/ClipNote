{"version":3,"file":"popup.js","mappings":"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","sources":["webpack://workspace/webpack/runtime/chunk loaded","webpack://workspace/./src/ui/popup.ts","webpack://workspace/webpack/bootstrap","webpack://workspace/webpack/runtime/define property getters","webpack://workspace/webpack/runtime/hasOwnProperty shorthand","webpack://workspace/webpack/runtime/jsonp chunk loading","webpack://workspace/webpack/startup"],"sourcesContent":["var deferred = [];\n__webpack_require__.O = (result, chunkIds, fn, priority) => {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar [chunkIds, fn, priority] = deferred[i];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","import { ScrapeResult } from '../types';\nimport { storage } from '../core/storage';\nimport { Logger, toastManager } from '../core/logger';\nimport { formatPrice, formatMileage, generateFacebookTitle } from '../core/normalize';\n\nclass PopupManager {\n  private logger = new Logger('Popup');\n  private currentTab: chrome.tabs.Tab | null = null;\n  private currentScrapeResult: ScrapeResult | null = null;\n\n  constructor() {\n    this.init();\n  }\n\n  private async init(): Promise<void> {\n    this.logger.info('Initializing popup');\n    \n    try {\n      // Get current tab\n      await this.getCurrentTab();\n      \n      // Setup event listeners\n      this.setupEventListeners();\n      \n      // Check page status\n      await this.checkPageStatus();\n      \n      // Load recent scrapes\n      await this.loadRecentScrapes();\n      \n      this.logger.info('Popup initialized successfully');\n    } catch (error) {\n      this.logger.error('Failed to initialize popup:', error);\n      this.showError('Failed to initialize extension');\n    }\n  }\n\n  private async getCurrentTab(): Promise<void> {\n    const tabs = await chrome.tabs.query({ active: true, currentWindow: true });\n    this.currentTab = tabs[0] || null;\n    \n    if (!this.currentTab) {\n      throw new Error('No active tab found');\n    }\n    \n    this.logger.debug('Current tab:', this.currentTab.url);\n  }\n\n  private setupEventListeners(): void {\n    // Scrape button\n    const scrapeBtn = document.getElementById('scrapeBtn');\n    scrapeBtn?.addEventListener('click', () => this.handleScrape());\n\n    // Facebook button\n    const facebookBtn = document.getElementById('facebookBtn');\n    facebookBtn?.addEventListener('click', () => this.handleFacebookAutofill());\n\n    // Download button\n    const downloadBtn = document.getElementById('downloadBtn');\n    downloadBtn?.addEventListener('click', () => this.handleDownloadPhotos());\n\n    // Full app button\n    const fullAppBtn = document.getElementById('fullAppBtn');\n    fullAppBtn?.addEventListener('click', () => this.openFullApp());\n\n    // Settings button\n    const settingsBtn = document.getElementById('settingsBtn');\n    settingsBtn?.addEventListener('click', () => this.openSettings());\n\n    this.logger.debug('Event listeners setup complete');\n  }\n\n  private async checkPageStatus(): Promise<void> {\n    \n    if (!this.currentTab?.url) {\n      this.updateStatus('❌', 'No page loaded', 'Please navigate to a vehicle page');\n      return;\n    }\n\n    try {\n      // Check if this is a supported site\n      const supportedSites = ['autotrader.com', 'cars.com', 'cargurus.com', 'dealer.com'];\n      const hostname = new URL(this.currentTab.url).hostname;\n      const isSupported = supportedSites.some(site => hostname.includes(site));\n\n      if (isSupported) {\n        // Send message to content script to check if it's a vehicle page\n        const response = await chrome.tabs.sendMessage(this.currentTab.id!, {\n          type: 'CHECK_VEHICLE_PAGE'\n        });\n\n        if (response?.isVehiclePage) {\n          this.updateStatus('✅', 'Vehicle page detected', 'Ready to scrape');\n          this.enableScraping();\n        } else {\n          this.updateStatus('⚠️', 'Not a vehicle page', 'Navigate to a vehicle detail page');\n        }\n      } else {\n        this.updateStatus('🔍', 'Unknown site', 'Will use generic scraping');\n        this.enableScraping();\n      }\n    } catch (error) {\n      this.logger.warn('Could not check page status:', error);\n      this.updateStatus('🔍', 'Page check failed', 'Generic scraping available');\n      this.enableScraping();\n    }\n  }\n\n  private updateStatus(icon: string, title: string, subtitle: string): void {\n    const statusElement = document.getElementById('pageStatus');\n    const iconElement = statusElement?.querySelector('.status-icon');\n    const titleElement = statusElement?.querySelector('.status-title');\n    const subtitleElement = statusElement?.querySelector('.status-subtitle');\n\n    if (iconElement) iconElement.textContent = icon;\n    if (titleElement) titleElement.textContent = title;\n    if (subtitleElement) subtitleElement.textContent = subtitle;\n  }\n\n  private enableScraping(): void {\n    const scrapeBtn = document.getElementById('scrapeBtn') as HTMLButtonElement;\n    if (scrapeBtn) {\n      scrapeBtn.disabled = false;\n    }\n  }\n\n  private async handleScrape(): Promise<void> {\n    if (!this.currentTab?.id) {\n      this.showError('No active tab');\n      return;\n    }\n\n    this.showLoading(true);\n    this.logger.info('Starting scrape operation');\n\n    try {\n      // Send scrape message to background script\n      const response = await chrome.runtime.sendMessage({\n        type: 'SCRAPE_PAGE'\n      });\n\n      if (response.error) {\n        throw new Error(response.error);\n      }\n\n      this.currentScrapeResult = response.result;\n      if (this.currentScrapeResult) {\n        this.displayScrapeResults(this.currentScrapeResult);\n      }\n      this.showPostScrapeActions();\n      \n      toastManager.show('Vehicle data scraped successfully!', 'success');\n      this.logger.info('Scrape completed successfully');\n\n    } catch (error) {\n      this.logger.error('Scrape failed:', error);\n      this.showError('Failed to scrape page: ' + (error as Error).message);\n    } finally {\n      this.showLoading(false);\n    }\n  }\n\n  private displayScrapeResults(result: ScrapeResult): void {\n    const resultsSection = document.getElementById('scrapeResults');\n    const titleElement = document.getElementById('vehicleTitle');\n    const priceElement = document.getElementById('vehiclePrice');\n    const mileageElement = document.getElementById('vehicleMileage');\n    const photoCountElement = document.getElementById('photoCount');\n    const photoPreviewElement = document.getElementById('photoPreview');\n\n    if (!resultsSection) return;\n\n    // Show results section\n    resultsSection.classList.remove('hidden');\n\n    // Update vehicle info\n    if (titleElement) {\n      titleElement.textContent = generateFacebookTitle(result.vehicle) || 'Unknown Vehicle';\n    }\n\n    if (priceElement) {\n      priceElement.textContent = result.vehicle.price ? formatPrice(result.vehicle.price) : 'Price N/A';\n    }\n\n    if (mileageElement) {\n      mileageElement.textContent = result.vehicle.mileage ? formatMileage(result.vehicle.mileage) : 'Mileage N/A';\n    }\n\n    // Update photo info\n    if (photoCountElement) {\n      const count = result.photos.length;\n      photoCountElement.textContent = `${count} photo${count !== 1 ? 's' : ''}`;\n    }\n\n    // Show photo preview\n    if (photoPreviewElement) {\n      photoPreviewElement.innerHTML = '';\n      \n      if (result.photos.length > 0) {\n        const previewCount = Math.min(3, result.photos.length);\n        for (let i = 0; i < previewCount; i++) {\n          const img = document.createElement('img');\n          img.src = result.photos[i].url;\n          img.className = 'photo-thumb';\n          img.onerror = () => {\n            img.style.display = 'none';\n          };\n          photoPreviewElement.appendChild(img);\n        }\n\n        if (result.photos.length > 3) {\n          const more = document.createElement('div');\n          more.className = 'photo-more';\n          more.textContent = `+${result.photos.length - 3}`;\n          photoPreviewElement.appendChild(more);\n        }\n      }\n    }\n\n    // Show warnings if any\n    this.displayWarnings(result.warnings);\n  }\n\n  private displayWarnings(warnings: string[]): void {\n    const warningsSection = document.getElementById('warnings');\n    const warningsList = document.getElementById('warningsList');\n\n    if (!warningsSection || !warningsList) return;\n\n    if (warnings.length > 0) {\n      warningsSection.classList.remove('hidden');\n      warningsList.innerHTML = '';\n      \n      warnings.forEach(warning => {\n        const li = document.createElement('li');\n        li.textContent = warning;\n        warningsList.appendChild(li);\n      });\n    } else {\n      warningsSection.classList.add('hidden');\n    }\n  }\n\n  private showPostScrapeActions(): void {\n    const actionsElement = document.getElementById('postScrapeActions');\n    if (actionsElement) {\n      actionsElement.classList.remove('hidden');\n    }\n  }\n\n  private async handleFacebookAutofill(): Promise<void> {\n    if (!this.currentScrapeResult) {\n      this.showError('No scrape data available');\n      return;\n    }\n\n    this.showLoading(true);\n    this.logger.info('Starting Facebook autofill');\n\n    try {\n      const response = await chrome.runtime.sendMessage({\n        type: 'OPEN_FACEBOOK_MARKETPLACE',\n        scrapeResult: this.currentScrapeResult\n      });\n\n      if (response.error) {\n        throw new Error(response.error);\n      }\n\n      toastManager.show('Facebook Marketplace opened! Autofill starting...', 'info');\n      this.logger.info('Facebook autofill initiated');\n\n      // Close popup after successful initiation\n      setTimeout(() => window.close(), 1000);\n\n    } catch (error) {\n      this.logger.error('Facebook autofill failed:', error);\n      this.showError('Failed to open Facebook: ' + (error as Error).message);\n    } finally {\n      this.showLoading(false);\n    }\n  }\n\n  private async handleDownloadPhotos(): Promise<void> {\n    if (!this.currentScrapeResult?.photos.length) {\n      this.showError('No photos to download');\n      return;\n    }\n\n    this.showLoading(true);\n    this.logger.info('Starting photo download');\n\n    try {\n      const photoUrls = this.currentScrapeResult.photos.map(p => p.url);\n      \n      const response = await chrome.runtime.sendMessage({\n        type: 'DOWNLOAD_PHOTOS',\n        photos: photoUrls\n      });\n\n      if (response.error) {\n        throw new Error(response.error);\n      }\n\n      toastManager.show(`Downloaded ${response.count} photos`, 'success');\n      this.logger.info(`Downloaded ${response.count} photos`);\n\n    } catch (error) {\n      this.logger.error('Photo download failed:', error);\n      this.showError('Failed to download photos: ' + (error as Error).message);\n    } finally {\n      this.showLoading(false);\n    }\n  }\n\n  private openFullApp(): void {\n    chrome.tabs.create({ url: chrome.runtime.getURL('src/ui/options.html') });\n    window.close();\n  }\n\n  private openSettings(): void {\n    chrome.tabs.create({ url: chrome.runtime.getURL('src/ui/options.html#settings') });\n    window.close();\n  }\n\n  private async loadRecentScrapes(): Promise<void> {\n    try {\n      const results = await storage.getScrapeResults();\n      const recentResults = results.slice(0, 5); // Show only 5 most recent\n\n      const recentList = document.getElementById('recentList');\n      if (!recentList) return;\n\n      if (recentResults.length === 0) {\n        recentList.innerHTML = `\n          <div class=\"empty-state\">\n            <div class=\"empty-icon\">📭</div>\n            <div class=\"empty-text\">No recent scrapes</div>\n          </div>\n        `;\n        return;\n      }\n\n      recentList.innerHTML = '';\n      \n      recentResults.forEach(result => {\n        const item = this.createRecentItem(result);\n        recentList.appendChild(item);\n      });\n\n    } catch (error) {\n      this.logger.error('Failed to load recent scrapes:', error);\n    }\n  }\n\n  private createRecentItem(result: ScrapeResult): HTMLElement {\n    const item = document.createElement('div');\n    item.className = 'recent-item';\n    \n    const title = generateFacebookTitle(result.vehicle) || 'Unknown Vehicle';\n    const price = result.vehicle.price ? formatPrice(result.vehicle.price) : 'N/A';\n    const date = new Date(result.scrapedAt).toLocaleDateString();\n    const hostname = new URL(result.sourceUrl).hostname;\n\n    item.innerHTML = `\n      <div class=\"recent-info\">\n        <div class=\"recent-title\">${title}</div>\n        <div class=\"recent-details\">\n          <span class=\"recent-price\">${price}</span>\n          <span class=\"recent-site\">${hostname}</span>\n          <span class=\"recent-date\">${date}</span>\n        </div>\n      </div>\n      <button class=\"recent-action\" data-id=\"${result.id}\">\n        <svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n          <path d=\"M9 12l2 2 4-4\"></path>\n          <path d=\"M21 12c-1 0-3-1-3-3s2-3 3-3 3 1 3 3-2 3-3 3\"></path>\n          <path d=\"M3 12c1 0 3-1 3-3s-2-3-3-3-3 1-3 3 2 3 3 3\"></path>\n        </svg>\n      </button>\n    `;\n\n    // Add click handler for action button\n    const actionBtn = item.querySelector('.recent-action') as HTMLButtonElement;\n    actionBtn?.addEventListener('click', (e) => {\n      e.stopPropagation();\n      this.handleRecentItemAction(result);\n    });\n\n    return item;\n  }\n\n  private async handleRecentItemAction(result: ScrapeResult): Promise<void> {\n    this.currentScrapeResult = result;\n    this.displayScrapeResults(result);\n    this.showPostScrapeActions();\n    \n    toastManager.show('Previous scrape data loaded', 'info');\n  }\n\n  private showLoading(show: boolean): void {\n    const overlay = document.getElementById('loadingOverlay');\n    if (overlay) {\n      if (show) {\n        overlay.classList.remove('hidden');\n      } else {\n        overlay.classList.add('hidden');\n      }\n    }\n  }\n\n  private showError(message: string): void {\n    toastManager.show(message, 'error');\n  }\n}\n\n// Initialize popup when DOM is ready\nif (document.readyState === 'loading') {\n  document.addEventListener('DOMContentLoaded', () => new PopupManager());\n} else {\n  new PopupManager();\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t887: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = (chunkId) => (installedChunks[chunkId] === 0);\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some((id) => (installedChunks[id] !== 0))) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkworkspace\"] = self[\"webpackChunkworkspace\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [76], () => (__webpack_require__(10)))\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["deferred","PopupManager","constructor","logger","currentTab","currentScrapeResult","this","init","info","getCurrentTab","setupEventListeners","checkPageStatus","loadRecentScrapes","error","showError","tabs","chrome","query","active","currentWindow","Error","debug","url","scrapeBtn","document","getElementById","addEventListener","handleScrape","facebookBtn","handleFacebookAutofill","downloadBtn","handleDownloadPhotos","fullAppBtn","openFullApp","settingsBtn","openSettings","supportedSites","hostname","URL","some","site","includes","response","sendMessage","id","type","isVehiclePage","updateStatus","enableScraping","warn","icon","title","subtitle","statusElement","iconElement","querySelector","titleElement","subtitleElement","textContent","disabled","showLoading","runtime","result","displayScrapeResults","showPostScrapeActions","show","message","resultsSection","priceElement","mileageElement","photoCountElement","photoPreviewElement","classList","remove","vehicle","price","mileage","count","photos","length","innerHTML","previewCount","Math","min","i","img","createElement","src","className","onerror","style","display","appendChild","more","displayWarnings","warnings","warningsSection","warningsList","forEach","warning","li","add","actionsElement","scrapeResult","setTimeout","window","close","photoUrls","map","p","create","getURL","recentResults","getScrapeResults","slice","recentList","item","createRecentItem","date","Date","scrapedAt","toLocaleDateString","sourceUrl","actionBtn","e","stopPropagation","handleRecentItemAction","overlay","readyState","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","O","chunkIds","fn","priority","notFulfilled","Infinity","fulfilled","j","Object","keys","every","key","splice","r","d","definition","o","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","installedChunks","chunkId","webpackJsonpCallback","parentChunkLoadingFunction","data","moreModules","chunkLoadingGlobal","self","bind","push","__webpack_exports__"],"sourceRoot":""}