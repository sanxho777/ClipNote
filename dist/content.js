(()=>{"use strict";var e,t={620:(e,t,i)=>{var n=i(265);class r{constructor(){this.logger=new n.Vy("SelectorProbe")}findElement(e){for(const t of e)try{const e=document.querySelector(t);if(e)return this.logger.debug(`Found element with selector: ${t}`),e}catch(e){this.logger.warn(`Invalid selector: ${t}`,e)}return this.logger.debug(`No element found with selectors: ${e.join(", ")}`),null}findElements(e){const t=[];for(const i of e)try{const e=document.querySelectorAll(i);t.push(...Array.from(e))}catch(e){this.logger.warn(`Invalid selector: ${i}`,e)}const i=Array.from(new Set(t));return this.logger.debug(`Found ${i.length} unique elements`),i}findByLabel(e,t){const i=t||document;for(const t of e){const e=this.findLabelElement(t,i);if(e){const i=this.getAssociatedElement(e);if(i)return this.logger.debug(`Found element by label association: ${t}`),i}const n=this.findByProximity(t,i);if(n)return this.logger.debug(`Found element by proximity: ${t}`),n}return this.logger.debug(`No element found by labels: ${e.join(", ")}`),null}findByProximity(e,t=document){const i=e.toLowerCase(),n=this.findTextNodes(t,i);for(const t of n){const i=t.parentElement;if(!i)continue;const n=this.findNearbyFormElements(i);for(const t of n)if(this.isRelevantFormElement(t))return this.logger.debug(`Found element by proximity to text: ${e}`),t}return null}findByAria(e){for(const t of e){let e=document.querySelector(`[aria-label*="${t}" i]`);if(e)return this.logger.debug(`Found element by aria-label: ${t}`),e;const i=document.querySelector(`[aria-labelledby*="${t}" i]`);if(i)return this.logger.debug(`Found element by aria-labelledby: ${t}`),i;if(e=document.querySelector(`[aria-describedby*="${t}" i]`),e)return this.logger.debug(`Found element by aria-describedby: ${t}`),e}return null}async waitForElement(e,t=1e4){const i=Date.now();for(;Date.now()-i<t;){const t=this.findElement(e);if(t)return t;await new Promise(e=>setTimeout(e,100))}return this.logger.warn(`Timeout waiting for element: ${e.join(", ")}`),null}isVisible(e){const t=e.getBoundingClientRect(),i=getComputedStyle(e);return t.width>0&&t.height>0&&"hidden"!==i.visibility&&"none"!==i.display&&"0"!==i.opacity}getElementInfo(e){const t=e.getBoundingClientRect(),i=getComputedStyle(e);return{tagName:e.tagName,id:e.id,className:e.className,textContent:e.textContent?.slice(0,100),visible:this.isVisible(e),position:{x:t.x,y:t.y,width:t.width,height:t.height},style:{display:i.display,visibility:i.visibility,opacity:i.opacity}}}findLabelElement(e,t){const i=t.querySelectorAll("label, .label, [data-label]");for(const t of i){const i=t.textContent?.toLowerCase()||"",n=t.getAttribute("data-label")?.toLowerCase()||"";if(i.includes(e.toLowerCase())||n.includes(e.toLowerCase()))return t}return null}getAssociatedElement(e){const t=e.getAttribute("for");if(t){const e=document.getElementById(t);if(e)return e}const i=e.querySelector("input, select, textarea");if(i)return i;let n=e.nextElementSibling;for(;n;){if(this.isRelevantFormElement(n))return n;n=n.nextElementSibling}return null}findTextNodes(e,t){const i=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,{acceptNode:e=>(e.textContent?.toLowerCase()||"").includes(t)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}),n=[];let r;for(;r=i.nextNode();)n.push(r);return n}findNearbyFormElements(e){const t=[];let i=e.parentElement,n=0;for(;i&&n<3;){const e=i.querySelectorAll("input, select, textarea, button");t.push(...Array.from(e)),i=i.parentElement,n++}const r=e.querySelectorAll("input, select, textarea, button");t.push(...Array.from(r));let o=e.previousElementSibling;for(n=0;o&&n<3;){this.isRelevantFormElement(o)&&t.push(o);const e=o.querySelectorAll("input, select, textarea, button");t.push(...Array.from(e)),o=o.previousElementSibling,n++}for(o=e.nextElementSibling,n=0;o&&n<3;){this.isRelevantFormElement(o)&&t.push(o);const e=o.querySelectorAll("input, select, textarea, button");t.push(...Array.from(e)),o=o.nextElementSibling,n++}return t}isRelevantFormElement(e){const t=e.tagName.toLowerCase();if(!["input","select","textarea"].includes(t))return!1;const i=e.type?.toLowerCase();return("input"!==t||!["hidden","submit","button","reset"].includes(i))&&this.isVisible(e)}}var o=i(6);const a=new n.Vy("Photos");async function s(e){a.info("Extracting photos with selectors:",e);const t=[],i=new Set,n=new Set;e.forEach(e=>{document.querySelectorAll(e).forEach(e=>{e instanceof HTMLImageElement&&n.add(e)})}),a.debug(`Found ${n.size} image elements`);for(const e of n)try{const n=c(e);for(const r of n){const n=d(l(r));if(n&&!i.has(n)&&h(n)){i.add(n);const r={url:n,width:e.naturalWidth||e.width||void 0,height:e.naturalHeight||e.height||void 0,isMain:u(e)};t.push(r)}}}catch(e){a.warn("Error processing image:",e)}return t.sort((e,t)=>{if(e.isMain&&!t.isMain)return-1;if(!e.isMain&&t.isMain)return 1;const i=(e.width||0)*(e.height||0);return(t.width||0)*(t.height||0)-i}),a.info(`Extracted ${t.length} unique photos`),t}function c(e){const t=[];if(e.src&&t.push(e.src),e.srcset){const i=function(e){const t=e.split(",").map(e=>e.trim()),i=[];return t.forEach(e=>{const t=e.split(/\s+/);if(t.length>=1){const e=t[0];let n=0;if(t.length>1){const e=t[1];if(e.endsWith("w"))n=parseInt(e.slice(0,-1))||0;else if(e.endsWith("x")){const t=parseFloat(e.slice(0,-1))||1;n=Math.round(1920*t)}}i.push({url:e,width:n})}}),i.sort((e,t)=>t.width-e.width).map(e=>e.url)}(e.srcset);t.push(...i)}["data-src","data-original","data-lazy","data-full","data-large"].forEach(i=>{const n=e.getAttribute(i);n&&t.push(n)});let i=e.parentElement;for(;i&&i!==document.body;){const e=getComputedStyle(i).backgroundImage;if(e&&"none"!==e){const i=e.match(/url\(['"]?([^'"]+)['"]?\)/);i&&t.push(i[1])}i=i.parentElement}return t}function l(e){if(e.startsWith("http://")||e.startsWith("https://"))return e;if(e.startsWith("//"))return window.location.protocol+e;if(e.startsWith("/"))return window.location.origin+e;const t=window.location.pathname.replace(/\/[^\/]*$/,"/");return window.location.origin+t+e}function d(e){try{const t=new URL(e);return["utm_source","utm_medium","utm_campaign","utm_content","gclid","fbclid","_ga","ref","referrer"].forEach(e=>{t.searchParams.delete(e)}),t.hash="",t.toString()}catch(t){return e}}function h(e){try{const t=new URL(e).pathname.toLowerCase();return!![".jpg",".jpeg",".png",".gif",".webp",".bmp"].some(e=>t.endsWith(e))||["/image/","/img/","/photo/","/picture/","/gallery/","images.","photos.","media.","cdn."].some(t=>e.toLowerCase().includes(t))}catch(e){return!1}}function u(e){const t=["hero","main","primary","featured","highlight","large","big","banner"],i=e.className.toLowerCase(),n=e.id.toLowerCase();if(t.some(e=>i.includes(e)||n.includes(e)))return!0;let r=e.parentElement,o=0;for(;r&&o<3;){const e=r.className.toLowerCase(),i=r.id.toLowerCase();if(t.some(t=>e.includes(t)||i.includes(t)))return!0;r=r.parentElement,o++}return(e.naturalWidth||e.width||0)*(e.naturalHeight||e.height||0)>5e5}class p{constructor(){this.name="AutoTrader",this.hostnames=["autotrader.com","www.autotrader.com"],this.logger=new n.Vy("AutoTrader"),this.probe=new r}isVehiclePage(e){return/\/cars-for-sale\/vehicledetails\.xhtml|\/vehicle\/\d+/i.test(e)}async scrape(){this.logger.info("Starting AutoTrader scrape");const e=[],t={},i={};try{await this.extractTitleInfo(t,e),await this.extractPriceAndMileage(t,e),await this.extractSpecs(t,e),await this.extractDealerInfo(i,e),await this.extractVIN(t,e),await this.extractDescription(t,e);const n=await this.extractPhotos(e),r={vehicle:(0,o.CS)(t),dealer:i,photos:n,sourceUrl:window.location.href,scrapedAt:Date.now(),warnings:e,id:`autotrader_${Date.now()}_${Math.random().toString(36).substr(2,9)}`};return this.logger.info("AutoTrader scrape completed",r),r}catch(e){throw this.logger.error("AutoTrader scrape failed:",e),new Error(`AutoTrader scraping failed: ${e.message}`)}}async extractTitleInfo(e,t){const i=this.probe.findElement([".vehicle-title h1",'[data-cmp="vehicleTitle"]',".vehicle-header h1",'h1[data-cmp="vehicleTitle"]',".vdp-header h1"]);if(i){const n=i.textContent?.trim()||"";this.logger.debug("Found title:",n);const r=n.match(/(\d{4})\s+([A-Za-z]+)\s+([A-Za-z0-9\s]+?)(?:\s+([A-Za-z0-9\s]+))?$/);if(r){e.year=parseInt(r[1]),e.make=r[2];const t=r[3].trim().split(/\s+/);e.model=t[0],t.length>1&&(e.trim=t.slice(1).join(" ")),r[4]&&(e.trim=(e.trim?e.trim+" ":"")+r[4])}else t.push("Could not parse vehicle title format")}else t.push("Vehicle title not found")}async extractPriceAndMileage(e,t){const i=this.probe.findElement(['[data-cmp="firstPrice"]',".first-price",".vehicle-price .price-value",".price-section .price",'[data-testid="price"]']);if(i){const t=(i.textContent?.replace(/[$,]/g,"")||"").match(/(\d+)/);t&&(e.price=parseInt(t[1]))}else t.push("Price not found");const n=this.probe.findElement(['[data-cmp="mileage"]',".vehicle-mileage",".mileage-value",".specs-section .mileage"]);if(n){const t=(n.textContent?.replace(/[,\s]/g,"")||"").match(/(\d+)/);t&&(e.mileage=parseInt(t[1]))}else{const i=/(\d{1,3}(?:,\d{3})*)\s*miles?/i,n=(document.body.textContent||"").match(i);n?e.mileage=parseInt(n[1].replace(/,/g,"")):t.push("Mileage not found")}}async extractSpecs(e,t){const i=this.probe.findElement([".vehicle-specs",".specifications",".specs-section",'[data-cmp="vehicleSpecs"]']);if(i&&i.querySelectorAll("li, .spec-item, .specification-item").forEach(t=>{const i=t.textContent?.toLowerCase()||"",n=t.textContent?.trim()||"";i.includes("transmission")?e.transmission=this.extractSpecValue(n,"transmission"):i.includes("drivetrain")||i.includes("drive")?e.drivetrain=this.extractSpecValue(n,"drivetrain"):i.includes("engine")?e.engine=this.extractSpecValue(n,"engine"):i.includes("fuel")?e.fuelType=this.extractSpecValue(n,"fuel"):i.includes("exterior")&&i.includes("color")?e.exteriorColor=this.extractSpecValue(n,"exterior color"):i.includes("interior")&&i.includes("color")?e.interiorColor=this.extractSpecValue(n,"interior color"):i.includes("body")&&i.includes("style")&&(e.bodyStyle=this.extractSpecValue(n,"body style"))}),!e.transmission){const t=this.probe.findByLabel(["transmission","trans"]);t&&(e.transmission=t.textContent?.trim())}if(!e.exteriorColor){const t=this.probe.findByLabel(["exterior color","color","ext color"]);t&&(e.exteriorColor=t.textContent?.trim())}}extractSpecValue(e,t){const i=e.split(":");if(i.length>1)return i[1].trim();const n=new RegExp(t+"\\s*:?\\s*([^\\n\\r]+)","i"),r=e.match(n);return r?r[1].trim():e.trim()}async extractDealerInfo(e,t){const i=this.probe.findElement([".dealer-name",'[data-cmp="dealerName"]',".dealer-info .name",".seller-name"]);i&&(e.name=i.textContent?.trim());const n=this.probe.findElement([".dealer-contact",".contact-info",'[data-cmp="dealerContact"]']);if(n){const t=n.textContent||"",i=t.match(/(\d{3}[-.\s]?\d{3}[-.\s]?\d{4})/);i&&(e.phone=i[1]);const r=t.match(/([A-Za-z\s]+),\s*([A-Z]{2})\s*(\d{5})/);r&&(e.city=r[1].trim(),e.state=r[2],e.zip=r[3])}}async extractVIN(e,t){const i=this.probe.findByLabel(["vin","vehicle identification number"]);if(i)e.vin=i.textContent?.trim();else{const i=/\b[A-HJ-NPR-Z0-9]{17}\b/,n=(document.body.textContent||"").match(i);n?e.vin=n[0]:t.push("VIN not found")}}async extractDescription(e,t){const i=this.probe.findElement([".vehicle-description",'[data-cmp="vehicleDescription"]',".description-content",".vehicle-comments"]);i?e.description=i.textContent?.trim():t.push("Description not found")}async extractPhotos(e){try{return await s([".vehicle-gallery img",'[data-cmp="vehicleGallery"] img',".gallery-thumbnail img",".hero-image img"])}catch(t){return e.push("Failed to extract photos: "+t.message),[]}}}class m{constructor(){this.name="Cars.com",this.hostnames=["cars.com","www.cars.com"],this.logger=new n.Vy("Cars.com"),this.probe=new r}isVehiclePage(e){return/\/vehicledetail\/|\/listing\/|\/vehicle\//i.test(e)}async scrape(){this.logger.info("Starting Cars.com scrape");const e=[],t={},i={};try{await this.extractTitleInfo(t,e),await this.extractPriceAndMileage(t,e),await this.extractSpecs(t,e),await this.extractDealerInfo(i,e),await this.extractVIN(t,e),await this.extractDescription(t,e);const n=await this.extractPhotos(e),r={vehicle:(0,o.CS)(t),dealer:i,photos:n,sourceUrl:window.location.href,scrapedAt:Date.now(),warnings:e,id:`cars_com_${Date.now()}_${Math.random().toString(36).substr(2,9)}`};return this.logger.info("Cars.com scrape completed",r),r}catch(e){throw this.logger.error("Cars.com scrape failed:",e),new Error(`Cars.com scraping failed: ${e.message}`)}}async extractTitleInfo(e,t){const i=this.probe.findElement(['h1[data-testid="structured-data-title"]',".vehicle-title h1",".listing-title h1","h1.vehicle-info-title",'[data-testid="vehicle-title"]']);if(i){const n=i.textContent?.trim()||"";this.logger.debug("Found title:",n);const r=n.match(/(\d{4})\s+([A-Za-z]+)\s+([A-Za-z0-9\s]+?)(?:\s+([A-Za-z0-9\s]+))?$/);if(r){e.year=parseInt(r[1]),e.make=r[2];const t=r[3].trim().split(/\s+/);e.model=t[0],t.length>1&&(e.trim=t.slice(1).join(" ")),r[4]&&(e.trim=(e.trim?e.trim+" ":"")+r[4])}else t.push("Could not parse vehicle title format")}else t.push("Vehicle title not found")}async extractPriceAndMileage(e,t){const i=this.probe.findElement(['[data-testid="price"]',".primary-price",".vehicle-price .price",".listing-price"]);if(i){const t=(i.textContent?.replace(/[$,]/g,"")||"").match(/(\d+)/);t&&(e.price=parseInt(t[1]))}else t.push("Price not found");const n=this.probe.findElement(['[data-testid="mileage"]',".vehicle-mileage",".listing-mileage",".mileage-display"]);if(n){const t=(n.textContent?.replace(/[,\s]/g,"")||"").match(/(\d+)/);t&&(e.mileage=parseInt(t[1]))}else{const i=/(\d{1,3}(?:,\d{3})*)\s*miles?/i,n=(document.body.textContent||"").match(i);n?e.mileage=parseInt(n[1].replace(/,/g,"")):t.push("Mileage not found")}}async extractSpecs(e,t){const i=this.probe.findElement(['[data-testid="specifications"]',".vehicle-specs",".specifications-section",".vehicle-features"]);if(i){const t=i.querySelectorAll("li, .spec-row, .feature-item, dt, dd");let n="";t.forEach((t,i)=>{const r=t.textContent?.toLowerCase()||"",o=t.textContent?.trim()||"";"dt"===t.tagName.toLowerCase()?n=r:"dd"===t.tagName.toLowerCase()&&n?(this.parseSpecField(n,o,e),n=""):r.includes("transmission")?e.transmission=this.extractSpecValue(o,"transmission"):r.includes("drivetrain")||r.includes("drive type")?e.drivetrain=this.extractSpecValue(o,"drivetrain"):r.includes("engine")?e.engine=this.extractSpecValue(o,"engine"):r.includes("fuel type")?e.fuelType=this.extractSpecValue(o,"fuel type"):r.includes("exterior color")?e.exteriorColor=this.extractSpecValue(o,"exterior color"):r.includes("interior color")?e.interiorColor=this.extractSpecValue(o,"interior color"):(r.includes("body style")||r.includes("body type"))&&(e.bodyStyle=this.extractSpecValue(o,"body style"))})}const n=document.querySelector("[data-make], [data-model], [data-year]");n&&(!e.make&&n.getAttribute("data-make")&&(e.make=n.getAttribute("data-make")),!e.model&&n.getAttribute("data-model")&&(e.model=n.getAttribute("data-model")),!e.year&&n.getAttribute("data-year")&&(e.year=parseInt(n.getAttribute("data-year"))))}parseSpecField(e,t,i){e.includes("transmission")?i.transmission=t:e.includes("drivetrain")||e.includes("drive")?i.drivetrain=t:e.includes("engine")?i.engine=t:e.includes("fuel")?i.fuelType=t:e.includes("exterior")&&e.includes("color")?i.exteriorColor=t:e.includes("interior")&&e.includes("color")?i.interiorColor=t:e.includes("body")&&(i.bodyStyle=t)}extractSpecValue(e,t){const i=e.split(":");if(i.length>1)return i[1].trim();const n=new RegExp(t+"\\s*:?\\s*([^\\n\\r]+)","i"),r=e.match(n);return r?r[1].trim():e.trim()}async extractDealerInfo(e,t){const i=this.probe.findElement(['[data-testid="dealer-name"]',".dealer-name",".seller-name",".dealership-name"]);i&&(e.name=i.textContent?.trim());const n=this.probe.findElement(['[data-testid="dealer-contact"]',".dealer-contact",".contact-info",".dealer-info"]);if(n){const t=n.textContent||"",i=t.match(/(\d{3}[-.\s]?\d{3}[-.\s]?\d{4})/);i&&(e.phone=i[1]);const r=t.match(/([A-Za-z\s]+),\s*([A-Z]{2})\s*(\d{5})/);r&&(e.city=r[1].trim(),e.state=r[2],e.zip=r[3])}}async extractVIN(e,t){const i=document.querySelector("[data-vin]");if(i)e.vin=i.getAttribute("data-vin")||void 0;else{const i=this.probe.findByLabel(["vin","vehicle identification number"]);if(i)e.vin=i.textContent?.trim();else{const i=/\b[A-HJ-NPR-Z0-9]{17}\b/,n=(document.body.textContent||"").match(i);n?e.vin=n[0]:t.push("VIN not found")}}}async extractDescription(e,t){const i=this.probe.findElement(['[data-testid="description"]',".vehicle-description",".listing-description",".description-content"]);i?e.description=i.textContent?.trim():t.push("Description not found")}async extractPhotos(e){try{return await s(['[data-testid^="gallery-image"] img',".vehicle-gallery img",".image-gallery img",".listing-photos img"])}catch(t){return e.push("Failed to extract photos: "+t.message),[]}}}class g{constructor(){this.name="CarGurus",this.hostnames=["cargurus.com","www.cargurus.com"],this.logger=new n.Vy("CarGurus"),this.probe=new r}isVehiclePage(e){return/\/cars\/l-|\/vehicle\/\d+/i.test(e)}async scrape(){this.logger.info("Starting CarGurus scrape");const e=[],t={},i={};try{await this.extractTitleInfo(t,e),await this.extractPriceAndMileage(t,e),await this.extractSpecs(t,e),await this.extractDealerInfo(i,e),await this.extractVIN(t,e),await this.extractDescription(t,e);const n=await this.extractPhotos(e),r={vehicle:(0,o.CS)(t),dealer:i,photos:n,sourceUrl:window.location.href,scrapedAt:Date.now(),warnings:e,id:`cargurus_${Date.now()}_${Math.random().toString(36).substr(2,9)}`};return this.logger.info("CarGurus scrape completed",r),r}catch(e){throw this.logger.error("CarGurus scrape failed:",e),new Error(`CarGurus scraping failed: ${e.message}`)}}async extractTitleInfo(e,t){const i=this.probe.findElement([".cg-listingDetail-model",'h1[data-cg-ft="listing-title"]',".listing-title h1",".vehicle-title",".vdp-header h1"]);if(i){const n=i.textContent?.trim()||"";this.logger.debug("Found title:",n);const r=n.match(/(\d{4})\s+([A-Za-z]+)\s+([A-Za-z0-9\s]+?)(?:\s+([A-Za-z0-9\s]+))?$/);if(r){e.year=parseInt(r[1]),e.make=r[2];const t=r[3].trim().split(/\s+/);e.model=t[0],t.length>1&&(e.trim=t.slice(1).join(" ")),r[4]&&(e.trim=(e.trim?e.trim+" ":"")+r[4])}else t.push("Could not parse vehicle title format")}else t.push("Vehicle title not found")}async extractPriceAndMileage(e,t){const i=this.probe.findElement([".cg-listingDetail-price",'[data-cg-ft="listing-price"]',".listing-price",".price-section .price"]);if(i){const t=(i.textContent?.replace(/[$,]/g,"")||"").match(/(\d+)/);t&&(e.price=parseInt(t[1]))}else t.push("Price not found");const n=this.probe.findElement([".cg-listingDetail-mileage",'[data-cg-ft="listing-mileage"]',".listing-mileage",".mileage-display"]);if(n){const t=(n.textContent?.replace(/[,\s]/g,"")||"").match(/(\d+)/);t&&(e.mileage=parseInt(t[1]))}else{const i=/(\d{1,3}(?:,\d{3})*)\s*miles?/i,n=(document.body.textContent||"").match(i);n?e.mileage=parseInt(n[1].replace(/,/g,"")):t.push("Mileage not found")}}async extractSpecs(e,t){const i=this.probe.findElement([".cg-listingDetail-specs",".vehicle-specs",".specifications",".listing-specs"]);if(i&&i.querySelectorAll("li, .spec-item, .detail-item").forEach(t=>{const i=t.textContent?.toLowerCase()||"",n=t.textContent?.trim()||"";i.includes("transmission")?e.transmission=this.extractSpecValue(n,"transmission"):i.includes("drivetrain")||i.includes("drive type")?e.drivetrain=this.extractSpecValue(n,"drivetrain"):i.includes("engine")?e.engine=this.extractSpecValue(n,"engine"):i.includes("fuel")?e.fuelType=this.extractSpecValue(n,"fuel"):i.includes("exterior")&&i.includes("color")?e.exteriorColor=this.extractSpecValue(n,"exterior color"):i.includes("interior")&&i.includes("color")?e.interiorColor=this.extractSpecValue(n,"interior color"):i.includes("body")&&(i.includes("style")||i.includes("type"))&&(e.bodyStyle=this.extractSpecValue(n,"body style"))}),!e.transmission){const t=this.probe.findByLabel(["transmission","trans"],i||void 0);t&&(e.transmission=t.textContent?.trim())}if(!e.exteriorColor){const t=this.probe.findByLabel(["exterior color","color"],i||void 0);t&&(e.exteriorColor=t.textContent?.trim())}}extractSpecValue(e,t){const i=e.split(":");if(i.length>1)return i[1].trim();const n=new RegExp(t+"\\s*:?\\s*([^\\n\\r]+)","i"),r=e.match(n);return r?r[1].trim():e.trim()}async extractDealerInfo(e,t){const i=this.probe.findElement([".cg-listingDetail-dealerName",'[data-cg-ft="dealer-name"]',".dealer-name",".seller-name"]);i&&(e.name=i.textContent?.trim());const n=this.probe.findElement([".cg-listingDetail-dealerContact",".dealer-contact",".contact-info",".dealer-info"]);if(n){const t=n.textContent||"",i=t.match(/(\d{3}[-.\s]?\d{3}[-.\s]?\d{4})/);i&&(e.phone=i[1]);const r=t.match(/([A-Za-z\s]+),\s*([A-Z]{2})\s*(\d{5})/);r&&(e.city=r[1].trim(),e.state=r[2],e.zip=r[3])}}async extractVIN(e,t){const i=this.probe.findElement([".cg-listingDetail-vin",'[data-cg-ft="vin"]']);if(i)e.vin=i.textContent?.trim();else{const i=this.probe.findByLabel(["vin","vehicle identification number"]);if(i)e.vin=i.textContent?.trim();else{const i=/\b[A-HJ-NPR-Z0-9]{17}\b/,n=(document.body.textContent||"").match(i);n?e.vin=n[0]:t.push("VIN not found")}}}async extractDescription(e,t){const i=this.probe.findElement([".cg-listingDetail-description",".vehicle-description",".listing-description",".description-content"]);i?e.description=i.textContent?.trim():t.push("Description not found")}async extractPhotos(e){try{return await s([".cg-listingDetail-photoViewer img",".vehicle-photos img",".image-gallery img",".listing-gallery img"])}catch(t){return e.push("Failed to extract photos: "+t.message),[]}}}class f{constructor(){this.name="Dealer.com",this.hostnames=["dealer.com","www.dealer.com"],this.logger=new n.Vy("Dealer.com"),this.probe=new r}isVehiclePage(e){return/\/inventory\/|\/vehicle\/|\/vdp\//i.test(e)}async scrape(){this.logger.info("Starting Dealer.com scrape");const e=[],t={},i={};try{await this.extractTitleInfo(t,e),await this.extractPriceAndMileage(t,e),await this.extractSpecs(t,e),await this.extractDealerInfo(i,e),await this.extractVIN(t,e),await this.extractDescription(t,e);const n=await this.extractPhotos(e),r={vehicle:(0,o.CS)(t),dealer:i,photos:n,sourceUrl:window.location.href,scrapedAt:Date.now(),warnings:e,id:`dealer_com_${Date.now()}_${Math.random().toString(36).substr(2,9)}`};return this.logger.info("Dealer.com scrape completed",r),r}catch(e){throw this.logger.error("Dealer.com scrape failed:",e),new Error(`Dealer.com scraping failed: ${e.message}`)}}async extractTitleInfo(e,t){const i=this.probe.findElement([".vdp-header h1",".vehicle-title h1",".inventory-title",".model-year-make","h1.vehicle-name"]);if(i){const n=i.textContent?.trim()||"";this.logger.debug("Found title:",n);const r=n.match(/(\d{4})\s+([A-Za-z]+)\s+([A-Za-z0-9\s]+?)(?:\s+([A-Za-z0-9\s]+))?$/);if(r){e.year=parseInt(r[1]),e.make=r[2];const t=r[3].trim().split(/\s+/);e.model=t[0],t.length>1&&(e.trim=t.slice(1).join(" ")),r[4]&&(e.trim=(e.trim?e.trim+" ":"")+r[4])}else t.push("Could not parse vehicle title format")}else t.push("Vehicle title not found")}async extractPriceAndMileage(e,t){const i=this.probe.findElement([".vehicle-price .price",".price-value",".listing-price",".vdp-price",".msrp-price"]);if(i){const t=(i.textContent?.replace(/[$,]/g,"")||"").match(/(\d+)/);t&&(e.price=parseInt(t[1]))}else t.push("Price not found");const n=this.probe.findElement([".vehicle-mileage",".mileage-value",".odometer",".vdp-mileage"]);if(n){const t=(n.textContent?.replace(/[,\s]/g,"")||"").match(/(\d+)/);t&&(e.mileage=parseInt(t[1]))}else{const i=/(\d{1,3}(?:,\d{3})*)\s*miles?/i,n=(document.body.textContent||"").match(i);n?e.mileage=parseInt(n[1].replace(/,/g,"")):t.push("Mileage not found")}}async extractSpecs(e,t){const i=this.probe.findElement([".vehicle-specs",".specifications",".vehicle-features",".vdp-specs"]);i&&i.querySelectorAll("li, .spec-item, .feature-item, tr").forEach(t=>{const i=t.textContent?.toLowerCase()||"",n=t.textContent?.trim()||"";i.includes("transmission")?e.transmission=this.extractSpecValue(n,"transmission"):i.includes("drivetrain")||i.includes("drive type")?e.drivetrain=this.extractSpecValue(n,"drivetrain"):i.includes("engine")?e.engine=this.extractSpecValue(n,"engine"):i.includes("fuel")?e.fuelType=this.extractSpecValue(n,"fuel"):i.includes("exterior")&&i.includes("color")?e.exteriorColor=this.extractSpecValue(n,"exterior color"):i.includes("interior")&&i.includes("color")?e.interiorColor=this.extractSpecValue(n,"interior color"):i.includes("body")&&(i.includes("style")||i.includes("type"))&&(e.bodyStyle=this.extractSpecValue(n,"body style"))});const n=this.probe.findElement([".specs-table",".vehicle-details-table"]);n&&n.querySelectorAll("tr").forEach(t=>{const i=t.querySelectorAll("td, th");if(i.length>=2){const t=i[0].textContent?.toLowerCase()||"",n=i[1].textContent?.trim()||"";t.includes("transmission")?e.transmission=n:t.includes("drivetrain")||t.includes("drive")?e.drivetrain=n:t.includes("engine")?e.engine=n:t.includes("fuel")?e.fuelType=n:t.includes("exterior")&&t.includes("color")?e.exteriorColor=n:t.includes("interior")&&t.includes("color")?e.interiorColor=n:t.includes("body")&&(e.bodyStyle=n)}})}extractSpecValue(e,t){const i=e.split(":");if(i.length>1)return i[1].trim();const n=new RegExp(t+"\\s*:?\\s*([^\\n\\r]+)","i"),r=e.match(n);return r?r[1].trim():e.trim()}async extractDealerInfo(e,t){const i=this.probe.findElement([".dealer-name",".dealership-name",".seller-name",".vdp-dealer-name"]);i&&(e.name=i.textContent?.trim());const n=this.probe.findElement([".dealer-contact",".contact-info",".dealer-info",".dealership-contact"]);if(n){const t=n.textContent||"",i=t.match(/(\d{3}[-.\s]?\d{3}[-.\s]?\d{4})/);i&&(e.phone=i[1]);const r=t.match(/([A-Za-z\s]+),\s*([A-Z]{2})\s*(\d{5})/);r&&(e.city=r[1].trim(),e.state=r[2],e.zip=r[3])}}async extractVIN(e,t){const i=this.probe.findByLabel(["vin","vehicle identification number"]);if(i)e.vin=i.textContent?.trim();else{const i=/\b[A-HJ-NPR-Z0-9]{17}\b/,n=(document.body.textContent||"").match(i);n?e.vin=n[0]:t.push("VIN not found")}}async extractDescription(e,t){const i=this.probe.findElement([".vehicle-description",".description-content",".vehicle-comments",".vdp-description"]);i?e.description=i.textContent?.trim():t.push("Description not found")}async extractPhotos(e){try{return await s([".vehicle-gallery img",".photo-gallery img",".image-gallery img",".vdp-photos img"])}catch(t){return e.push("Failed to extract photos: "+t.message),[]}}}class y{constructor(){this.name="Generic",this.hostnames=["*"],this.logger=new n.Vy("Generic"),this.probe=new r}isVehiclePage(e){return["vehicle","car","auto","inventory","details","listing","vdp","used-car","new-car"].some(t=>e.toLowerCase().includes(t))}async scrape(){this.logger.info("Starting generic scrape");const e=[],t={},i={};try{await this.extractFromMicrodata(t,e),await this.extractFromOpenGraph(t,e),await this.extractFromStructuredData(t,e),await this.extractFromHeuristics(t,i,e);const n=await this.extractPhotos(e),r={vehicle:(0,o.CS)(t),dealer:i,photos:n,sourceUrl:window.location.href,scrapedAt:Date.now(),warnings:e,id:`generic_${Date.now()}_${Math.random().toString(36).substr(2,9)}`};return this.logger.info("Generic scrape completed",r),r}catch(e){throw this.logger.error("Generic scrape failed:",e),new Error(`Generic scraping failed: ${e.message}`)}}async extractFromMicrodata(e,t){document.querySelectorAll('[itemtype*="Vehicle"], [itemtype*="Car"], [itemtype*="Auto"]').forEach(t=>{t.querySelectorAll("[itemprop]").forEach(t=>{const i=t.getAttribute("itemprop"),n=t.getAttribute("content")||t.textContent?.trim();if(n)switch(i){case"name":case"model":this.parseVehicleName(n,e);break;case"brand":case"manufacturer":e.make=n;break;case"productionDate":case"modelYear":e.year=parseInt(n);break;case"price":case"offers":const t=n.match(/(\d+)/);t&&(e.price=parseInt(t[1]));break;case"mileageFromOdometer":case"mileage":const i=n.match(/(\d+)/);i&&(e.mileage=parseInt(i[1]));break;case"vehicleIdentificationNumber":case"vin":e.vin=n;break;case"color":e.exteriorColor||(e.exteriorColor=n);break;case"description":e.description=n}})})}async extractFromOpenGraph(e,t){document.querySelectorAll('meta[property^="og:"]').forEach(t=>{const i=t.getAttribute("property"),n=t.getAttribute("content");if(n)switch(i){case"og:title":e.year&&e.make&&e.model||this.parseVehicleName(n,e);break;case"og:description":e.description||(e.description=n)}}),document.querySelectorAll('meta[name^="twitter:"]').forEach(t=>{const i=t.getAttribute("name"),n=t.getAttribute("content");n&&("twitter:title"!==i||e.year&&e.make&&e.model||this.parseVehicleName(n,e))})}async extractFromStructuredData(e,t){document.querySelectorAll('script[type="application/ld+json"]').forEach(t=>{try{const i=JSON.parse(t.textContent||"");if("Vehicle"===i["@type"]||"Car"===i["@type"]){if(i.name&&this.parseVehicleName(i.name,e),i.brand&&(e.make=i.brand),i.model&&(e.model=i.model),i.productionDate&&(e.year=parseInt(i.productionDate)),i.offers&&i.offers.price){const t=i.offers.price.toString().match(/(\d+)/);t&&(e.price=parseInt(t[1]))}i.mileageFromOdometer&&(e.mileage=parseInt(i.mileageFromOdometer)),i.vehicleIdentificationNumber&&(e.vin=i.vehicleIdentificationNumber),i.color&&(e.exteriorColor=i.color),i.description&&(e.description=i.description)}}catch(e){}})}async extractFromHeuristics(e,t,i){if(!e.year||!e.make||!e.model){const t=document.querySelectorAll("h1, h2, .title, .vehicle-title, .listing-title");for(const i of t){const t=i.textContent?.trim()||"";if(this.looksLikeVehicleTitle(t)){this.parseVehicleName(t,e);break}}}if(!e.price){const t=document.querySelectorAll('.price, .cost, .amount, [class*="price"], [id*="price"]');for(const i of t){const t=(i.textContent||"").match(/\$[\d,]+/);if(t){const i=parseInt(t[0].replace(/[$,]/g,""));if(i>1e3&&i<1e6){e.price=i;break}}}}if(!e.mileage){const t=(document.body.textContent||"").match(/(\d{1,3}(?:,\d{3})*)\s*miles?/i);t&&(e.mileage=parseInt(t[1].replace(/,/g,"")))}if(!e.vin){const t=(document.body.textContent||"").match(/\b[A-HJ-NPR-Z0-9]{17}\b/);t&&(e.vin=t[0])}if(!t.name){const e=document.querySelectorAll('.dealer, .dealership, .seller, [class*="dealer"], [id*="dealer"]');for(const i of e){const e=i.textContent?.trim();if(e&&e.length>3&&e.length<100){t.name=e;break}}}const n=(document.body.textContent||"").match(/(\d{3}[-.\s]?\d{3}[-.\s]?\d{4})/);n&&(t.phone=n[1]),this.extractSpecsByProximity(e,i)}looksLikeVehicleTitle(e){return/\d{4}\s+[A-Za-z]+\s+[A-Za-z0-9\s]+/.test(e)}parseVehicleName(e,t){const i=e.match(/(\d{4})\s+([A-Za-z]+)\s+([A-Za-z0-9\s]+?)(?:\s+([A-Za-z0-9\s]+))?$/);if(i){if(t.year||(t.year=parseInt(i[1])),t.make||(t.make=i[2]),!t.model){const e=i[3].trim().split(/\s+/);t.model=e[0],e.length>1&&!t.trim&&(t.trim=e.slice(1).join(" "))}i[4]&&!t.trim&&(t.trim=i[4])}}extractSpecsByProximity(e,t){Object.entries({transmission:["transmission","trans","automatic","manual","cvt"],drivetrain:["drivetrain","drive","awd","fwd","rwd","4wd"],engine:["engine","motor","cylinder","liter","turbo"],fuelType:["fuel","gas","gasoline","diesel","electric","hybrid"],exteriorColor:["exterior color","color","paint"],interiorColor:["interior color","interior"],bodyStyle:["body style","body type","sedan","suv","truck","coupe","hatchback"]}).forEach(([t,i])=>{if(!e[t])for(const n of i){const i=this.probe.findByLabel([n]);if(i){const n=i.textContent?.trim();if(n&&n.length>1&&n.length<100){e[t]=n;break}}}})}async extractPhotos(e){try{return await s([".gallery img",".photos img",".images img",'[class*="gallery"] img','[class*="photo"] img','[id*="gallery"] img','[id*="photo"] img'])}catch(t){return e.push("Failed to extract photos: "+t.message),[]}}}class w{constructor(){this.logger=new n.Vy("ScrapingEngine"),this.adapters=[],this.adapters=[new p,new m,new g,new f],this.genericAdapter=new y,this.logger.info("ScrapingEngine initialized with adapters:",this.adapters.map(e=>e.name))}async scrapeCurrentPage(){const e=window.location.href,t=window.location.hostname;this.logger.info("Starting scrape for:",e);const i=this.findAdapter(t,e);if(!i)throw new Error("No suitable adapter found for this site");this.logger.info("Using adapter:",i.name);try{const e=await i.scrape();return this.validateScrapeResult(e),this.logger.info("Scrape completed successfully"),e}catch(e){throw this.logger.error("Scrape failed:",e),e}}isVehiclePage(e){const t=new URL(e).hostname,i=this.findAdapter(t,e);return i?i.isVehiclePage(e):this.genericAdapter.isVehiclePage(e)}getSupportedSites(){return this.adapters.flatMap(e=>e.hostnames)}findAdapter(e,t){for(const i of this.adapters)if(this.matchesHostname(e,i.hostnames)&&i.isVehiclePage(t))return i;return this.genericAdapter.isVehiclePage(t)?this.genericAdapter:null}matchesHostname(e,t){return t.some(t=>{if("*"===t)return!0;const i=e.replace(/^www\./,""),n=t.replace(/^www\./,"");return i===n||i.endsWith("."+n)})}validateScrapeResult(e){const{vehicle:t}=e,i=[];if(["year","make","model","price"].forEach(e=>{t[e]||i.push(e)}),i.length>0&&e.warnings.push(`Missing required fields: ${i.join(", ")}`),t.vin&&(/^[A-HJ-NPR-Z0-9]{17}$/.test(t.vin)||e.warnings.push("VIN format appears invalid")),t.year){const i=(new Date).getFullYear();(t.year<1950||t.year>i+1)&&e.warnings.push("Vehicle year appears out of range")}t.price&&(t.price<100||t.price>1e6)&&e.warnings.push("Price appears out of normal range"),t.mileage&&(t.mileage<0||t.mileage>1e6)&&e.warnings.push("Mileage appears out of normal range"),0===e.photos.length&&e.warnings.push("No photos found"),this.logger.debug("Validation completed. Warnings:",e.warnings)}}class b{constructor(){this.logger=new n.Vy("FacebookAutofiller")}async autofillForm(e,t={}){this.logger.info("Starting Facebook Marketplace autofill");const{vehicle:i,dealer:n,photos:r}=e,o={condition:"Used",uploadPhotos:!0,maxPhotos:20,...t};try{await this.waitForPageReady(),await this.fillVehicleDetails(i,o),await this.fillLocationInfo(n),await this.fillDescription(i,n,e.vehicle.stockNumber),o.uploadPhotos&&r.length>0&&await this.uploadPhotos(r,o.maxPhotos),this.logger.info("Facebook autofill completed successfully")}catch(e){throw this.logger.error("Facebook autofill failed:",e),e}}async waitForPageReady(){this.logger.debug("Waiting for Facebook page to be ready"),await this.waitForSelector('[data-testid="marketplace_composer_form"], .marketplace-composer, form[data-testid*="composer"]',1e4),await this.sleep(2e3),this.logger.debug("Facebook page is ready")}async fillVehicleDetails(e,t){this.logger.debug("Filling vehicle details");const i=(0,o.WW)(e);await this.fillInput(['[data-testid="marketplace_composer_title"]','input[placeholder*="title" i]','input[name="title"]'],i),e.price&&await this.fillInput(['[data-testid="marketplace_composer_price"]','input[placeholder*="price" i]','input[name="price"]','input[type="number"]'],e.price.toString()),e.year&&await this.fillSelect(['select[data-testid*="year"]','select[name*="year"]'],e.year.toString()),e.make&&await this.fillSelect(['select[data-testid*="make"]','select[name*="make"]'],e.make),e.model&&await this.fillSelect(['select[data-testid*="model"]','select[name*="model"]'],e.model),e.mileage&&await this.fillInput(['[data-testid*="mileage"]','input[placeholder*="mileage" i]','input[name*="mileage"]'],e.mileage.toString()),e.vin&&await this.fillInput(['[data-testid*="vin"]','input[placeholder*="vin" i]','input[name*="vin"]'],e.vin);const n=t.condition||e.condition||"Used";await this.fillSelect(['select[data-testid*="condition"]','select[name*="condition"]'],n),e.transmission&&await this.fillSelect(['select[data-testid*="transmission"]','select[name*="transmission"]'],e.transmission),e.drivetrain&&await this.fillSelect(['select[data-testid*="drivetrain"]','select[name*="drivetrain"]','select[data-testid*="drive"]'],e.drivetrain),e.fuelType&&await this.fillSelect(['select[data-testid*="fuel"]','select[name*="fuel"]'],e.fuelType),e.bodyStyle&&await this.fillSelect(['select[data-testid*="body"]','select[name*="body"]','select[data-testid*="type"]'],e.bodyStyle),e.exteriorColor&&await this.fillSelect(['select[data-testid*="exterior"]','select[data-testid*="color"]','select[name*="color"]'],e.exteriorColor),this.logger.debug("Vehicle details filled")}async fillLocationInfo(e){if(!e.city&&!e.state&&!e.zip)return;this.logger.debug("Filling location info");const t=[e.city,e.state,e.zip].filter(Boolean).join(", ");await this.fillInput(['[data-testid*="location"]','input[placeholder*="location" i]','input[placeholder*="city" i]','input[name*="location"]','input[name*="city"]'],t),this.logger.debug("Location info filled")}async fillDescription(e,t,i){this.logger.debug("Filling description");const n=(0,o.q0)(e,t,i);await this.fillTextarea(['[data-testid*="description"]','textarea[placeholder*="description" i]','textarea[name*="description"]',"textarea"],n),this.logger.debug("Description filled")}async uploadPhotos(e,t){this.logger.info(`Starting photo upload (${Math.min(e.length,t)} photos)`);try{const i=e.slice(0,t),n=await async function(e){a.info(`Converting ${e.length} URLs to File objects`);const t=[];for(let i=0;i<e.length;i++)try{const n=e[i],r=await fetch(n.url);if(!r.ok){a.warn(`Failed to fetch photo ${i+1}: ${r.status}`);continue}const o=await r.blob();let s="jpg";const c=r.headers.get("content-type");c&&(c.includes("png")?s="png":c.includes("gif")?s="gif":c.includes("webp")&&(s="webp"));const l=`vehicle_photo_${i+1}.${s}`,d=new File([o],l,{type:o.type||"image/jpeg"});t.push(d),a.debug(`Converted photo ${i+1} to File: ${l}`)}catch(e){a.error(`Failed to convert photo ${i+1} to File:`,e)}return a.info(`Successfully converted ${t.length} photos to File objects`),t}(i);if(0===n.length)return void this.logger.warn("No files could be converted for upload");const r=await this.waitForSelector(['input[type="file"]','[data-testid*="photo"] input[type="file"]','[data-testid*="image"] input[type="file"]']);if(!r)throw new Error("Could not find file input for photo upload");const o=new DataTransfer;n.forEach(e=>{o.items.add(e)}),r.files=o.files;const s=new Event("change",{bubbles:!0});r.dispatchEvent(s);const c=new Event("input",{bubbles:!0});r.dispatchEvent(c),this.logger.info(`Uploaded ${n.length} photos successfully`)}catch(t){this.logger.error("Photo upload failed:",t),this.showPhotoUploadInstructions(e.length)}}showPhotoUploadInstructions(e){const t=`Automatic photo upload failed. Please manually upload the ${e} vehicle photos that have been downloaded to your Downloads folder.`;"Notification"in window&&"granted"===Notification.permission?new Notification("Photo Upload Required",{body:t,icon:chrome.runtime.getURL("public/icons/icon48.png")}):alert(t)}async fillInput(e,t){const i=await this.waitForSelector(e,5e3);i?(i.value="",i.focus(),i.value=t,i.dispatchEvent(new Event("input",{bubbles:!0})),i.dispatchEvent(new Event("change",{bubbles:!0})),i.dispatchEvent(new Event("blur",{bubbles:!0})),this.logger.debug(`Filled input with value: ${t}`)):this.logger.warn(`Could not find input with selectors: ${e.join(", ")}`)}async fillTextarea(e,t){const i=await this.waitForSelector(e,5e3);i?(i.value="",i.focus(),i.value=t,i.dispatchEvent(new Event("input",{bubbles:!0})),i.dispatchEvent(new Event("change",{bubbles:!0})),i.dispatchEvent(new Event("blur",{bubbles:!0})),this.logger.debug(`Filled textarea with ${t.length} characters`)):this.logger.warn(`Could not find textarea with selectors: ${e.join(", ")}`)}async fillSelect(e,t){const i=await this.waitForSelector(e,5e3);if(i){const e=Array.from(i.options).find(e=>e.value===t||e.textContent?.trim()===t);if(e)i.value=e.value;else{const e=Array.from(i.options).find(e=>e.textContent?.toLowerCase().includes(t.toLowerCase())||e.value.toLowerCase().includes(t.toLowerCase()));if(!e)return void this.logger.warn(`Could not find option "${t}" in select`);i.value=e.value}i.dispatchEvent(new Event("change",{bubbles:!0})),this.logger.debug(`Selected option: ${t}`)}else this.logger.warn(`Could not find select with selectors: ${e.join(", ")}`)}async waitForSelector(e,t=1e4){const i=Array.isArray(e)?e:[e],n=Date.now();for(;Date.now()-n<t;){for(const e of i){const t=document.querySelector(e);if(t)return t}await this.sleep(100)}return this.logger.warn(`Timeout waiting for selectors: ${i.join(", ")}`),null}sleep(e){return new Promise(t=>setTimeout(t,e))}}const x=new n.Vy("Content");let v,C=null;function S(){const e=window.location.hostname;x.info("Initializing content script on:",e),e.includes("facebook.com")?(C=new b,function(){const e=window.vehicleAutofillData;e&&C&&(x.info("Starting Facebook autofill with data:",e),setTimeout(()=>{C.autofillForm(e).catch(e=>{x.error("Autofill failed:",e)})},3e3)),window.addEventListener("message",e=>{"AUTOFILL_VEHICLE_DATA"===e.data.type&&C&&C.autofillForm(e.data.scrapeResult).catch(e=>{x.error("Autofill failed:",e)})})}()):(v=new w,window.vehicleScraper={scrape:async()=>{try{return await v.scrapeCurrentPage()}catch(e){return x.error("Scraping failed:",e),null}}},function(){if(!v.isVehiclePage(window.location.href))return;const e=document.createElement("div");e.id="vehicle-scraper-indicator",e.style.cssText="\n    position: fixed;\n    top: 20px;\n    right: 20px;\n    background: #1877f2;\n    color: white;\n    padding: 8px 12px;\n    border-radius: 6px;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;\n    font-size: 12px;\n    font-weight: 500;\n    z-index: 10000;\n    box-shadow: 0 2px 8px rgba(0,0,0,0.15);\n    cursor: pointer;\n    transition: all 0.2s ease;\n  ",e.textContent="ðŸš— Scrapable",e.addEventListener("mouseenter",()=>{e.style.transform="scale(1.05)"}),e.addEventListener("mouseleave",()=>{e.style.transform="scale(1)"}),e.addEventListener("click",()=>{chrome.runtime.sendMessage({type:"OPEN_POPUP"})}),document.body.appendChild(e),setTimeout(()=>{e.parentNode&&(e.style.opacity="0.3")},5e3)}())}chrome.runtime.onMessage.addListener((e,t,i)=>{switch(x.debug("Content script received message:",e),e.type){case"PAGE_LOADED":return v||C||S(),!1;case"SCRAPE_NOW":return!!v&&(v.scrapeCurrentPage().then(e=>i({success:!0,result:e})).catch(e=>i({error:e.message})),!0);case"AUTOFILL_FACEBOOK":return!!C&&(C.autofillForm(e.scrapeResult).then(()=>i({success:!0})).catch(e=>i({error:e.message})),!0);default:return!1}}),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",S):S();let E=window.location.href;new MutationObserver(()=>{const e=window.location.href;e!==E&&(E=e,setTimeout(S,1e3))}).observe(document,{subtree:!0,childList:!0})}},i={};function n(e){var r=i[e];if(void 0!==r)return r.exports;var o=i[e]={exports:{}};return t[e](o,o.exports,n),o.exports}n.m=t,e=[],n.O=(t,i,r,o)=>{if(!i){var a=1/0;for(d=0;d<e.length;d++){for(var[i,r,o]=e[d],s=!0,c=0;c<i.length;c++)(!1&o||a>=o)&&Object.keys(n.O).every(e=>n.O[e](i[c]))?i.splice(c--,1):(s=!1,o<a&&(a=o));if(s){e.splice(d--,1);var l=r();void 0!==l&&(t=l)}}return t}o=o||0;for(var d=e.length;d>0&&e[d-1][2]>o;d--)e[d]=e[d-1];e[d]=[i,r,o]},n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={854:0};n.O.j=t=>0===e[t];var t=(t,i)=>{var r,o,[a,s,c]=i,l=0;if(a.some(t=>0!==e[t])){for(r in s)n.o(s,r)&&(n.m[r]=s[r]);if(c)var d=c(n)}for(t&&t(i);l<a.length;l++)o=a[l],n.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return n.O(d)},i=self.webpackChunkworkspace=self.webpackChunkworkspace||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))})();var r=n.O(void 0,[76],()=>n(620));r=n.O(r)})();
//# sourceMappingURL=content.js.map